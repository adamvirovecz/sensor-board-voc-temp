<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Interactive BOM for KiCAD</title>
  <style type="text/css">
:root {
  --pcb-edge-color: black;
  --pad-color: #878787;
  --pad-hole-color: #CCCCCC;
  --pad-color-highlight: #D04040;
  --pad-color-highlight-both: #D0D040;
  --pad-color-highlight-marked: #44a344;
  --pin1-outline-color: #ffb629;
  --pin1-outline-color-highlight: #ffb629;
  --pin1-outline-color-highlight-both: #fcbb39;
  --pin1-outline-color-highlight-marked: #fdbe41;
  --silkscreen-edge-color: #aa4;
  --silkscreen-polygon-color: #4aa;
  --silkscreen-text-color: #4aa;
  --fabrication-edge-color: #907651;
  --fabrication-polygon-color: #907651;
  --fabrication-text-color: #a27c24;
  --track-color: #def5f1;
  --track-color-highlight: #D04040;
  --zone-color: #def5f1;
  --zone-color-highlight: #d0404080;
}

html,
body {
  margin: 0px;
  height: 100%;
  font-family: Verdana, sans-serif;
}

.dark.topmostdiv {
  --pcb-edge-color: #eee;
  --pad-color: #808080;
  --pin1-outline-color: #ffa800;
  --pin1-outline-color-highlight: #ccff00;
  --track-color: #42524f;
  --zone-color: #42524f;
  background-color: #252c30;
  color: #eee;
}

button {
  background-color: #eee;
  border: 1px solid #888;
  color: black;
  height: 44px;
  width: 44px;
  text-align: center;
  text-decoration: none;
  display: inline-block;
  font-size: 14px;
  font-weight: bolder;
}

.dark button {
  /* This will be inverted */
  background-color: #c3b7b5;
}

button.depressed {
  background-color: #0a0;
  color: white;
}

.dark button.depressed {
  /* This will be inverted */
  background-color: #b3b;
}

button:focus {
  outline: 0;
}

button#tb-btn {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 8.47 8.47'%3E%3Crect transform='translate(0 -288.53)' ry='1.17' y='288.8' x='.27' height='7.94' width='7.94' fill='%23f9f9f9'/%3E%3Cg transform='translate(0 -288.53)'%3E%3Crect width='7.94' height='7.94' x='.27' y='288.8' ry='1.17' fill='none' stroke='%23000' stroke-width='.4' stroke-linejoin='round'/%3E%3Cpath d='M1.32 290.12h5.82M1.32 291.45h5.82' fill='none' stroke='%23000' stroke-width='.4'/%3E%3Cpath d='M4.37 292.5v4.23M.26 292.63H8.2' fill='none' stroke='%23000' stroke-width='.3'/%3E%3Ctext font-weight='700' font-size='3.17' font-family='sans-serif'%3E%3Ctspan x='1.35' y='295.73'%3EF%3C/tspan%3E%3Ctspan x='5.03' y='295.68'%3EB%3C/tspan%3E%3C/text%3E%3C/g%3E%3C/svg%3E%0A");
}

button#lr-btn {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 8.47 8.47'%3E%3Crect transform='translate(0 -288.53)' ry='1.17' y='288.8' x='.27' height='7.94' width='7.94' fill='%23f9f9f9'/%3E%3Cg transform='translate(0 -288.53)'%3E%3Crect width='7.94' height='7.94' x='.27' y='288.8' ry='1.17' fill='none' stroke='%23000' stroke-width='.4' stroke-linejoin='round'/%3E%3Cpath d='M1.06 290.12H3.7m-2.64 1.33H3.7m-2.64 1.32H3.7m-2.64 1.3H3.7m-2.64 1.33H3.7' fill='none' stroke='%23000' stroke-width='.4'/%3E%3Cpath d='M4.37 288.8v7.94m0-4.11h3.96' fill='none' stroke='%23000' stroke-width='.3'/%3E%3Ctext font-weight='700' font-size='3.17' font-family='sans-serif'%3E%3Ctspan x='5.11' y='291.96'%3EF%3C/tspan%3E%3Ctspan x='5.03' y='295.68'%3EB%3C/tspan%3E%3C/text%3E%3C/g%3E%3C/svg%3E%0A");
}

button#bom-btn {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 8.47 8.47'%3E%3Crect transform='translate(0 -288.53)' ry='1.17' y='288.8' x='.27' height='7.94' width='7.94' fill='%23f9f9f9'/%3E%3Cg transform='translate(0 -288.53)' fill='none' stroke='%23000' stroke-width='.4'%3E%3Crect width='7.94' height='7.94' x='.27' y='288.8' ry='1.17' stroke-linejoin='round'/%3E%3Cpath d='M1.59 290.12h5.29M1.59 291.45h5.33M1.59 292.75h5.33M1.59 294.09h5.33M1.59 295.41h5.33'/%3E%3C/g%3E%3C/svg%3E");
}

button#bom-grouped-btn {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32'%3E%3Cg stroke='%23000' stroke-linejoin='round' class='layer'%3E%3Crect width='29' height='29' x='1.5' y='1.5' stroke-width='2' fill='%23fff' rx='5' ry='5'/%3E%3Cpath stroke-linecap='square' stroke-width='2' d='M6 10h4m4 0h5m4 0h3M6.1 22h3m3.9 0h5m4 0h4m-16-8h4m4 0h4'/%3E%3Cpath stroke-linecap='null' d='M5 17.5h22M5 26.6h22M5 5.5h22'/%3E%3C/g%3E%3C/svg%3E");
}

button#bom-ungrouped-btn {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32'%3E%3Cg stroke='%23000' stroke-linejoin='round' class='layer'%3E%3Crect width='29' height='29' x='1.5' y='1.5' stroke-width='2' fill='%23fff' rx='5' ry='5'/%3E%3Cpath stroke-linecap='square' stroke-width='2' d='M6 10h4m-4 8h3m-3 8h4'/%3E%3Cpath stroke-linecap='null' d='M5 13.5h22m-22 8h22M5 5.5h22'/%3E%3C/g%3E%3C/svg%3E");
}

button#bom-netlist-btn {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32'%3E%3Cg fill='none' stroke='%23000' class='layer'%3E%3Crect width='29' height='29' x='1.5' y='1.5' stroke-width='2' fill='%23fff' rx='5' ry='5'/%3E%3Cpath stroke-width='2' d='M6 26l6-6v-8m13.8-6.3l-6 6v8'/%3E%3Ccircle cx='11.8' cy='9.5' r='2.8' stroke-width='2'/%3E%3Ccircle cx='19.8' cy='22.8' r='2.8' stroke-width='2'/%3E%3C/g%3E%3C/svg%3E");
}

button#copy {
  background-image: url("data:image/svg+xml,%3Csvg height='48' viewBox='0 0 48 48' width='48' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M0 0h48v48h-48z' fill='none'/%3E%3Cpath d='M32 2h-24c-2.21 0-4 1.79-4 4v28h4v-28h24v-4zm6 8h-22c-2.21 0-4 1.79-4 4v28c0 2.21 1.79 4 4 4h22c2.21 0 4-1.79 4-4v-28c0-2.21-1.79-4-4-4zm0 32h-22v-28h22v28z'/%3E%3C/svg%3E");
  background-position: 6px 6px;
  background-repeat: no-repeat;
  background-size: 26px 26px;
  border-radius: 6px;
  height: 40px;
  width: 40px;
  margin: 10px 5px;
}

button#copy:active {
  box-shadow: inset 0px 0px 5px #6c6c6c;
}

textarea.clipboard-temp {
  position: fixed;
  top: 0;
  left: 0;
  width: 2em;
  height: 2em;
  padding: 0;
  border: None;
  outline: None;
  box-shadow: None;
  background: transparent;
}

.left-most-button {
  border-right: 0;
  border-top-left-radius: 6px;
  border-bottom-left-radius: 6px;
}

.middle-button {
  border-right: 0;
}

.right-most-button {
  border-top-right-radius: 6px;
  border-bottom-right-radius: 6px;
}

.button-container {
  font-size: 0;
  margin: 0.4rem 0.4rem 0.4rem 0;
}

.dark .button-container {
  filter: invert(1);
}

.button-container button {
  background-size: 32px 32px;
  background-position: 5px 5px;
  background-repeat: no-repeat;
}

@media print {
  .hideonprint {
    display: none;
  }
}

canvas {
  cursor: crosshair;
}

canvas:active {
  cursor: grabbing;
}

.fileinfo {
  width: 100%;
  max-width: 1000px;
  border: none;
  padding: 3px;
}

.fileinfo .title {
  font-size: 20pt;
  font-weight: bold;
}

.fileinfo td {
  overflow: hidden;
  white-space: nowrap;
  max-width: 1px;
  width: 50%;
  text-overflow: ellipsis;
}

.bom {
  border-collapse: collapse;
  font-family: Consolas, "DejaVu Sans Mono", Monaco, monospace;
  font-size: 10pt;
  table-layout: fixed;
  width: 100%;
  margin-top: 1px;
  position: relative;
}

.bom th,
.bom td {
  border: 1px solid black;
  padding: 5px;
  word-wrap: break-word;
  text-align: center;
  position: relative;
}

.dark .bom th,
.dark .bom td {
  border: 1px solid #777;
}

.bom th {
  background-color: #CCCCCC;
  background-clip: padding-box;
}

.dark .bom th {
  background-color: #3b4749;
}

.bom tr.highlighted:nth-child(n) {
  background-color: #cfc;
}

.dark .bom tr.highlighted:nth-child(n) {
  background-color: #226022;
}

.bom tr:nth-child(even) {
  background-color: #f2f2f2;
}

.dark .bom tr:nth-child(even) {
  background-color: #313b40;
}

.bom tr.checked {
  color: #1cb53d;
}

.dark .bom tr.checked {
  color: #2cce54;
}

.bom tr {
  transition: background-color 0.2s;
}

.bom .numCol {
  width: 30px;
}

.bom .value {
  width: 15%;
}

.bom .quantity {
  width: 65px;
}

.bom th .sortmark {
  position: absolute;
  right: 1px;
  top: 1px;
  margin-top: -5px;
  border-width: 5px;
  border-style: solid;
  border-color: transparent transparent #221 transparent;
  transform-origin: 50% 85%;
  transition: opacity 0.2s, transform 0.4s;
}

.dark .bom th .sortmark {
  filter: invert(1);
}

.bom th .sortmark.none {
  opacity: 0;
}

.bom th .sortmark.desc {
  transform: rotate(180deg);
}

.bom th:hover .sortmark.none {
  opacity: 0.5;
}

.bom .bom-checkbox {
  width: 30px;
  position: relative;
  user-select: none;
  -moz-user-select: none;
}

.bom .bom-checkbox:before {
  content: "";
  position: absolute;
  border-width: 15px;
  border-style: solid;
  border-color: #51829f transparent transparent transparent;
  visibility: hidden;
  top: -15px;
}

.bom .bom-checkbox:after {
  content: "Double click to set/unset all";
  position: absolute;
  color: white;
  top: -35px;
  left: -26px;
  background: #51829f;
  padding: 5px 15px;
  border-radius: 8px;
  white-space: nowrap;
  visibility: hidden;
}

.bom .bom-checkbox:hover:before,
.bom .bom-checkbox:hover:after {
  visibility: visible;
  transition: visibility 0.2s linear 1s;
}

.split {
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
  overflow-y: auto;
  overflow-x: hidden;
  background-color: inherit;
}

.split.split-horizontal,
.gutter.gutter-horizontal {
  height: 100%;
  float: left;
}

.gutter {
  background-color: #ddd;
  background-repeat: no-repeat;
  background-position: 50%;
  transition: background-color 0.3s;
}

.dark .gutter {
  background-color: #777;
}

.gutter.gutter-horizontal {
  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAeCAYAAADkftS9AAAAIklEQVQoU2M4c+bMfxAGAgYYmwGrIIiDjrELjpo5aiZeMwF+yNnOs5KSvgAAAABJRU5ErkJggg==');
  cursor: ew-resize;
  width: 5px;
}

.gutter.gutter-vertical {
  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAFAQMAAABo7865AAAABlBMVEVHcEzMzMzyAv2sAAAAAXRSTlMAQObYZgAAABBJREFUeF5jOAMEEAIEEFwAn3kMwcB6I2AAAAAASUVORK5CYII=');
  cursor: ns-resize;
  height: 5px;
}

.searchbox {
  float: left;
  height: 40px;
  margin: 10px 5px;
  padding: 12px 32px;
  font-family: Consolas, "DejaVu Sans Mono", Monaco, monospace;
  font-size: 18px;
  box-sizing: border-box;
  border: 1px solid #888;
  border-radius: 6px;
  outline: none;
  background-color: #eee;
  transition: background-color 0.2s, border 0.2s;
  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABNklEQVQ4T8XSMUvDQBQH8P/LElFa/AIZHcTBQSz0I/gFstTBRR2KUC4ldDxw7h0Bl3RRUATxi4iiODgoiLNrbQYp5J6cpJJqomkX33Z37/14d/dIa33MzDuYI4johOI4XhyNRteO46zNYjDzAxE1yBZprVeZ+QbAUhXEGJMA2Ox2u4+fQIa0mPmsCgCgJYQ4t7lfgF0opQYAdv9ABkKI/UnOFCClXKjX61cA1osQY8x9kiRNKeV7IWA3oyhaSdP0FkAtjxhj3hzH2RBCPOf3pzqYHCilfAAX+URm9oMguPzeWSGQvUcMYC8rOBJCHBRdqxTo9/vbRHRqi8bj8XKv1xvODbiuW2u32/bvf0SlDv4XYOY7z/Mavu+nM1+BmQ+NMc0wDF/LprP0DbTWW0T00ul0nn4b7Q87+X4Qmfiq2wAAAABJRU5ErkJggg==');
  background-position: 10px 10px;
  background-repeat: no-repeat;
}

.dark .searchbox {
  background-color: #111;
  color: #eee;
}

.searchbox::placeholder {
  color: #ccc;
}

.dark .searchbox::placeholder {
  color: #666;
}

.filter {
  width: calc(60% - 64px);
}

.reflookup {
  width: calc(40% - 10px);
}

input[type=text]:focus {
  background-color: white;
  border: 1px solid #333;
}

.dark input[type=text]:focus {
  background-color: #333;
  border: 1px solid #ccc;
}

mark.highlight {
  background-color: #5050ff;
  color: #fff;
  padding: 2px;
  border-radius: 6px;
}

.dark mark.highlight {
  background-color: #76a6da;
  color: #111;
}

.menubtn {
  background-color: white;
  border: none;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='36' height='36' viewBox='0 0 20 20'%3E%3Cpath fill='none' d='M0 0h20v20H0V0z'/%3E%3Cpath d='M15.95 10.78c.03-.25.05-.51.05-.78s-.02-.53-.06-.78l1.69-1.32c.15-.12.19-.34.1-.51l-1.6-2.77c-.1-.18-.31-.24-.49-.18l-1.99.8c-.42-.32-.86-.58-1.35-.78L12 2.34c-.03-.2-.2-.34-.4-.34H8.4c-.2 0-.36.14-.39.34l-.3 2.12c-.49.2-.94.47-1.35.78l-1.99-.8c-.18-.07-.39 0-.49.18l-1.6 2.77c-.1.18-.06.39.1.51l1.69 1.32c-.04.25-.07.52-.07.78s.02.53.06.78L2.37 12.1c-.15.12-.19.34-.1.51l1.6 2.77c.1.18.31.24.49.18l1.99-.8c.42.32.86.58 1.35.78l.3 2.12c.04.2.2.34.4.34h3.2c.2 0 .37-.14.39-.34l.3-2.12c.49-.2.94-.47 1.35-.78l1.99.8c.18.07.39 0 .49-.18l1.6-2.77c.1-.18.06-.39-.1-.51l-1.67-1.32zM10 13c-1.65 0-3-1.35-3-3s1.35-3 3-3 3 1.35 3 3-1.35 3-3 3z'/%3E%3C/svg%3E%0A");
  background-position: center;
  background-repeat: no-repeat;
}

.statsbtn {
  background-color: white;
  border: none;
  background-image: url("data:image/svg+xml,%3Csvg width='36' height='36' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M4 6h28v24H4V6zm0 8h28v8H4m9-16v24h10V5.8' fill='none' stroke='%23000' stroke-width='2'/%3E%3C/svg%3E");
  background-position: center;
  background-repeat: no-repeat;
}

.iobtn {
  background-color: white;
  border: none;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='36' height='36'%3E%3Cpath fill='none' stroke='%23000' stroke-width='2' d='M3 33v-7l6.8-7h16.5l6.7 7v7H3zM3.2 26H33M21 9l5-5.9 5 6h-2.5V15h-5V9H21zm-4.9 0l-5 6-5-6h2.5V3h5v6h2.5z'/%3E%3Cpath fill='none' stroke='%23000' d='M6.1 29.5H10'/%3E%3C/svg%3E");
  background-position: center;
  background-repeat: no-repeat;
}

.visbtn {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24'%3E%3Cpath fill='none' stroke='%23333' d='M2.5 4.5h5v15h-5zM9.5 4.5h5v15h-5zM16.5 4.5h5v15h-5z'/%3E%3C/svg%3E");
  background-position: center;
  background-repeat: no-repeat;
  padding: 15px;
}

#vismenu-content {
  left: 0px;
  font-family: Verdana, sans-serif;
}

.dark .statsbtn,
.dark .savebtn,
.dark .menubtn,
.dark .iobtn,
.dark .visbtn {
  filter: invert(1);
}

.flexbox {
  display: flex;
  align-items: center;
  justify-content: space-between;
  width: 100%;
}

.savebtn {
  background-color: #d6d6d6;
  width: auto;
  height: 30px;
  flex-grow: 1;
  margin: 5px;
  border-radius: 4px;
}

.savebtn:active {
  background-color: #0a0;
  color: white;
}

.dark .savebtn:active {
  /* This will be inverted */
  background-color: #b3b;
}

.stats {
  border-collapse: collapse;
  font-size: 12pt;
  table-layout: fixed;
  width: 100%;
  min-width: 450px;
}

.dark .stats td {
  border: 1px solid #bbb;
}

.stats td {
  border: 1px solid black;
  padding: 5px;
  word-wrap: break-word;
  text-align: center;
  position: relative;
}

#checkbox-stats div {
  position: absolute;
  left: 0;
  top: 0;
  height: 100%;
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
}

#checkbox-stats .bar {
  background-color: rgba(28, 251, 0, 0.6);
}

.menu {
  position: relative;
  display: inline-block;
  margin: 0.4rem 0.4rem 0.4rem 0;
}

.menu-content {
  font-size: 12pt !important;
  text-align: left !important;
  font-weight: normal !important;
  display: none;
  position: absolute;
  background-color: white;
  right: 0;
  min-width: 300px;
  box-shadow: 0px 8px 16px 0px rgba(0, 0, 0, 0.2);
  z-index: 100;
  padding: 8px;
}

.dark .menu-content {
  background-color: #111;
}

.menu:hover .menu-content {
  display: block;
}

.menu:hover .menubtn,
.menu:hover .iobtn,
.menu:hover .statsbtn {
  background-color: #eee;
}

.menu-label {
  display: inline-block;
  padding: 8px;
  border: 1px solid #ccc;
  border-top: 0;
  width: calc(100% - 18px);
}

.menu-label-top {
  border-top: 1px solid #ccc;
}

.menu-textbox {
  float: left;
  height: 24px;
  margin: 10px 5px;
  padding: 5px 5px;
  font-family: Consolas, "DejaVu Sans Mono", Monaco, monospace;
  font-size: 14px;
  box-sizing: border-box;
  border: 1px solid #888;
  border-radius: 4px;
  outline: none;
  background-color: #eee;
  transition: background-color 0.2s, border 0.2s;
  width: calc(100% - 10px);
}

.menu-textbox.invalid,
.dark .menu-textbox.invalid {
  color: red;
}

.dark .menu-textbox {
  background-color: #222;
  color: #eee;
}

.radio-container {
  margin: 4px;
}

.topmostdiv {
  display: flex;
  flex-direction: column;
  width: 100%;
  background-color: white;
  transition: background-color 0.3s;
}

#top {
  display: flex;
  flex-wrap: wrap;
  justify-content: flex-end;
  align-items: center;
}

#topdivider {
  border-bottom: 2px solid black;
  display: flex;
  justify-content: center;
  align-items: center;
}

.dark #topdivider {
  border-bottom: 2px solid #ccc;
}

#topdivider>div {
  position: relative;
}

#toptoggle {
  cursor: pointer;
  user-select: none;
  position: absolute;
  padding: 0.1rem 0.3rem;
  top: -0.4rem;
  left: -1rem;
  font-size: 1.4rem;
  line-height: 60%;
  border: 1px solid black;
  border-radius: 1rem;
  background-color: #fff;
  z-index: 100;
}

.flipped {
  transform: rotate(0.5turn);
}

.dark #toptoggle {
  border: 1px solid #fff;
  background-color: #222;
}

#fileinfodiv {
  flex: 20rem 1 0;
  overflow: auto;
}

#bomcontrols {
  display: flex;
  flex-direction: row-reverse;
}

#bomcontrols>* {
  flex-shrink: 0;
}

#dbg {
  display: block;
}

::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: #aaa;
}

::-webkit-scrollbar-thumb {
  background: #666;
  border-radius: 3px;
}

::-webkit-scrollbar-thumb:hover {
  background: #555;
}

.slider {
  -webkit-appearance: none;
  width: 100%;
  margin: 3px 0;
  padding: 0;
  outline: none;
  opacity: 0.7;
  -webkit-transition: .2s;
  transition: opacity .2s;
  border-radius: 3px;
}

.slider:hover {
  opacity: 1;
}

.slider:focus {
  outline: none;
}

.slider::-webkit-slider-runnable-track {
  -webkit-appearance: none;
  width: 100%;
  height: 8px;
  background: #d3d3d3;
  border-radius: 3px;
  border: none;
}

.slider::-webkit-slider-thumb {
  -webkit-appearance: none;
  width: 15px;
  height: 15px;
  border-radius: 50%;
  background: #0a0;
  cursor: pointer;
  margin-top: -4px;
}

.dark .slider::-webkit-slider-thumb {
  background: #3d3;
}

.slider::-moz-range-thumb {
  width: 15px;
  height: 15px;
  border-radius: 50%;
  background: #0a0;
  cursor: pointer;
}

.slider::-moz-range-track {
  height: 8px;
  background: #d3d3d3;
  border-radius: 3px;
}

.dark .slider::-moz-range-thumb {
  background: #3d3;
}

.slider::-ms-track {
  width: 100%;
  height: 8px;
  border-width: 3px 0;
  background: transparent;
  border-color: transparent;
  color: transparent;
  transition: opacity .2s;
}

.slider::-ms-fill-lower {
  background: #d3d3d3;
  border: none;
  border-radius: 3px;
}

.slider::-ms-fill-upper {
  background: #d3d3d3;
  border: none;
  border-radius: 3px;
}

.slider::-ms-thumb {
  width: 15px;
  height: 15px;
  border-radius: 50%;
  background: #0a0;
  cursor: pointer;
  margin: 0;
}

.shameless-plug {
  font-size: 0.8em;
  text-align: center;
  display: block;
}

a {
  color: #0278a4;
}

.dark a {
  color: #00b9fd;
}

#frontcanvas,
#backcanvas {
  touch-action: none;
}

.placeholder {
  border: 1px dashed #9f9fda !important;
  background-color: #edf2f7 !important;
}

.dragging {
  z-index: 999;
}

.dark .dragging>table>tbody>tr {
  background-color: #252c30;
}

.dark .placeholder {
  filter: invert(1);
}

.column-spacer {
  top: 0;
  left: 0;
  width: calc(100% - 4px);
  position: absolute;
  cursor: pointer;
  user-select: none;
  height: 100%;
}

.column-width-handle {
  top: 0;
  right: 0;
  width: 4px;
  position: absolute;
  cursor: col-resize;
  user-select: none;
  height: 100%;
}

.column-width-handle:hover {
  background-color: #4f99bd;
}

.help-link {
  border: 1px solid #0278a4;
  padding-inline: 0.3rem;
  border-radius: 3px;
  cursor: pointer;
}

.dark .help-link {
  border: 1px solid #00b9fd;
}

.bom-color {
  width: 20%;
}

.color-column input {
  width: 1.6rem;
  height: 1rem;
  border: 1px solid black;
  cursor: pointer;
  padding: 0;
}

/* removes default styling from input color element */
::-webkit-color-swatch {
  border: none;
}

::-webkit-color-swatch-wrapper {
  padding: 0;
}

::-moz-color-swatch,
::-moz-focus-inner {
  border: none;
}

::-moz-focus-inner {
  padding: 0;
}
/* #bomhead {
    position: sticky;
    top: 0px;
    z-index: 1;
} */
  </style>
  <script type="text/javascript" >
///////////////////////////////////////////////
/*
  Split.js - v1.3.5
  MIT License
  https://github.com/nathancahill/Split.js
*/
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.Split=t()}(this,function(){"use strict";var e=window,t=e.document,n="addEventListener",i="removeEventListener",r="getBoundingClientRect",s=function(){return!1},o=e.attachEvent&&!e[n],a=["","-webkit-","-moz-","-o-"].filter(function(e){var n=t.createElement("div");return n.style.cssText="width:"+e+"calc(9px)",!!n.style.length}).shift()+"calc",l=function(e){return"string"==typeof e||e instanceof String?t.querySelector(e):e};return function(u,c){function z(e,t,n){var i=A(y,t,n);Object.keys(i).forEach(function(t){return e.style[t]=i[t]})}function h(e,t){var n=B(y,t);Object.keys(n).forEach(function(t){return e.style[t]=n[t]})}function f(e){var t=E[this.a],n=E[this.b],i=t.size+n.size;t.size=e/this.size*i,n.size=i-e/this.size*i,z(t.element,t.size,this.aGutterSize),z(n.element,n.size,this.bGutterSize)}function m(e){var t;this.dragging&&((t="touches"in e?e.touches[0][b]-this.start:e[b]-this.start)<=E[this.a].minSize+M+this.aGutterSize?t=E[this.a].minSize+this.aGutterSize:t>=this.size-(E[this.b].minSize+M+this.bGutterSize)&&(t=this.size-(E[this.b].minSize+this.bGutterSize)),f.call(this,t),c.onDrag&&c.onDrag())}function g(){var e=E[this.a].element,t=E[this.b].element;this.size=e[r]()[y]+t[r]()[y]+this.aGutterSize+this.bGutterSize,this.start=e[r]()[G]}function d(){var t=this,n=E[t.a].element,r=E[t.b].element;t.dragging&&c.onDragEnd&&c.onDragEnd(),t.dragging=!1,e[i]("mouseup",t.stop),e[i]("touchend",t.stop),e[i]("touchcancel",t.stop),t.parent[i]("mousemove",t.move),t.parent[i]("touchmove",t.move),delete t.stop,delete t.move,n[i]("selectstart",s),n[i]("dragstart",s),r[i]("selectstart",s),r[i]("dragstart",s),n.style.userSelect="",n.style.webkitUserSelect="",n.style.MozUserSelect="",n.style.pointerEvents="",r.style.userSelect="",r.style.webkitUserSelect="",r.style.MozUserSelect="",r.style.pointerEvents="",t.gutter.style.cursor="",t.parent.style.cursor=""}function S(t){var i=this,r=E[i.a].element,o=E[i.b].element;!i.dragging&&c.onDragStart&&c.onDragStart(),t.preventDefault(),i.dragging=!0,i.move=m.bind(i),i.stop=d.bind(i),e[n]("mouseup",i.stop),e[n]("touchend",i.stop),e[n]("touchcancel",i.stop),i.parent[n]("mousemove",i.move),i.parent[n]("touchmove",i.move),r[n]("selectstart",s),r[n]("dragstart",s),o[n]("selectstart",s),o[n]("dragstart",s),r.style.userSelect="none",r.style.webkitUserSelect="none",r.style.MozUserSelect="none",r.style.pointerEvents="none",o.style.userSelect="none",o.style.webkitUserSelect="none",o.style.MozUserSelect="none",o.style.pointerEvents="none",i.gutter.style.cursor=j,i.parent.style.cursor=j,g.call(i)}function v(e){e.forEach(function(t,n){if(n>0){var i=F[n-1],r=E[i.a],s=E[i.b];r.size=e[n-1],s.size=t,z(r.element,r.size,i.aGutterSize),z(s.element,s.size,i.bGutterSize)}})}function p(){F.forEach(function(e){e.parent.removeChild(e.gutter),E[e.a].element.style[y]="",E[e.b].element.style[y]=""})}void 0===c&&(c={});var y,b,G,E,w=l(u[0]).parentNode,D=e.getComputedStyle(w).flexDirection,U=c.sizes||u.map(function(){return 100/u.length}),k=void 0!==c.minSize?c.minSize:100,x=Array.isArray(k)?k:u.map(function(){return k}),L=void 0!==c.gutterSize?c.gutterSize:10,M=void 0!==c.snapOffset?c.snapOffset:30,O=c.direction||"horizontal",j=c.cursor||("horizontal"===O?"ew-resize":"ns-resize"),C=c.gutter||function(e,n){var i=t.createElement("div");return i.className="gutter gutter-"+n,i},A=c.elementStyle||function(e,t,n){var i={};return"string"==typeof t||t instanceof String?i[e]=t:i[e]=o?t+"%":a+"("+t+"% - "+n+"px)",i},B=c.gutterStyle||function(e,t){return n={},n[e]=t+"px",n;var n};"horizontal"===O?(y="width","clientWidth",b="clientX",G="left","paddingLeft"):"vertical"===O&&(y="height","clientHeight",b="clientY",G="top","paddingTop");var F=[];return E=u.map(function(e,t){var i,s={element:l(e),size:U[t],minSize:x[t]};if(t>0&&(i={a:t-1,b:t,dragging:!1,isFirst:1===t,isLast:t===u.length-1,direction:O,parent:w},i.aGutterSize=L,i.bGutterSize=L,i.isFirst&&(i.aGutterSize=L/2),i.isLast&&(i.bGutterSize=L/2),"row-reverse"===D||"column-reverse"===D)){var a=i.a;i.a=i.b,i.b=a}if(!o&&t>0){var c=C(t,O);h(c,L),c[n]("mousedown",S.bind(i)),c[n]("touchstart",S.bind(i)),w.insertBefore(c,s.element),i.gutter=c}0===t||t===u.length-1?z(s.element,s.size,L/2):z(s.element,s.size,L);var f=s.element[r]()[y];return f<s.minSize&&(s.minSize=f),t>0&&F.push(i),s}),o?{setSizes:v,destroy:p}:{setSizes:v,getSizes:function(){return E.map(function(e){return e.size})},collapse:function(e){if(e===F.length){var t=F[e-1];g.call(t),o||f.call(t,t.size-t.bGutterSize)}else{var n=F[e];g.call(n),o||f.call(n,n.aGutterSize)}},destroy:p}}});

///////////////////////////////////////////////

///////////////////////////////////////////////
// Copyright (c) 2013 Pieroxy <pieroxy@pieroxy.net>
// This work is free. You can redistribute it and/or modify it
// under the terms of the WTFPL, Version 2
// For more information see LICENSE.txt or http://www.wtfpl.net/
//
// For more information, the home page:
// http://pieroxy.net/blog/pages/lz-string/testing.html
//
// LZ-based compression algorithm, version 1.4.4
var LZString=function(){var o=String.fromCharCode,i={};var n={decompressFromBase64:function(o){return null==o?"":""==o?null:n._decompress(o.length,32,function(n){return function(o,n){if(!i[o]){i[o]={};for(var t=0;t<o.length;t++)i[o][o.charAt(t)]=t}return i[o][n]}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",o.charAt(n))})},_decompress:function(i,n,t){var r,e,a,s,p,u,l,f=[],c=4,d=4,h=3,v="",g=[],m={val:t(0),position:n,index:1};for(r=0;r<3;r+=1)f[r]=r;for(a=0,p=Math.pow(2,2),u=1;u!=p;)s=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=t(m.index++)),a|=(s>0?1:0)*u,u<<=1;switch(a){case 0:for(a=0,p=Math.pow(2,8),u=1;u!=p;)s=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=t(m.index++)),a|=(s>0?1:0)*u,u<<=1;l=o(a);break;case 1:for(a=0,p=Math.pow(2,16),u=1;u!=p;)s=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=t(m.index++)),a|=(s>0?1:0)*u,u<<=1;l=o(a);break;case 2:return""}for(f[3]=l,e=l,g.push(l);;){if(m.index>i)return"";for(a=0,p=Math.pow(2,h),u=1;u!=p;)s=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=t(m.index++)),a|=(s>0?1:0)*u,u<<=1;switch(l=a){case 0:for(a=0,p=Math.pow(2,8),u=1;u!=p;)s=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=t(m.index++)),a|=(s>0?1:0)*u,u<<=1;f[d++]=o(a),l=d-1,c--;break;case 1:for(a=0,p=Math.pow(2,16),u=1;u!=p;)s=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=t(m.index++)),a|=(s>0?1:0)*u,u<<=1;f[d++]=o(a),l=d-1,c--;break;case 2:return g.join("")}if(0==c&&(c=Math.pow(2,h),h++),f[l])v=f[l];else{if(l!==d)return null;v=e+e.charAt(0)}g.push(v),f[d++]=e+v.charAt(0),e=v,0==--c&&(c=Math.pow(2,h),h++)}}};return n}();"function"==typeof define&&define.amd?define(function(){return LZString}):"undefined"!=typeof module&&null!=module?module.exports=LZString:"undefined"!=typeof angular&&null!=angular&&angular.module("LZString",[]).factory("LZString",function(){return LZString});
///////////////////////////////////////////////

///////////////////////////////////////////////
/*!
 * PEP v0.4.3 | https://github.com/jquery/PEP
 * Copyright jQuery Foundation and other contributors | http://jquery.org/license
 */
!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):a.PointerEventsPolyfill=b()}(this,function(){"use strict";function a(a,b){b=b||Object.create(null);var c=document.createEvent("Event");c.initEvent(a,b.bubbles||!1,b.cancelable||!1);
for(var d,e=2;e<m.length;e++)d=m[e],c[d]=b[d]||n[e];c.buttons=b.buttons||0;
var f=0;return f=b.pressure&&c.buttons?b.pressure:c.buttons?.5:0,c.x=c.clientX,c.y=c.clientY,c.pointerId=b.pointerId||0,c.width=b.width||0,c.height=b.height||0,c.pressure=f,c.tiltX=b.tiltX||0,c.tiltY=b.tiltY||0,c.twist=b.twist||0,c.tangentialPressure=b.tangentialPressure||0,c.pointerType=b.pointerType||"",c.hwTimestamp=b.hwTimestamp||0,c.isPrimary=b.isPrimary||!1,c}function b(){this.array=[],this.size=0}function c(a,b,c,d){this.addCallback=a.bind(d),this.removeCallback=b.bind(d),this.changedCallback=c.bind(d),A&&(this.observer=new A(this.mutationWatcher.bind(this)))}function d(a){return"body /shadow-deep/ "+e(a)}function e(a){return'[touch-action="'+a+'"]'}function f(a){return"{ -ms-touch-action: "+a+"; touch-action: "+a+"; }"}function g(){if(F){D.forEach(function(a){String(a)===a?(E+=e(a)+f(a)+"\n",G&&(E+=d(a)+f(a)+"\n")):(E+=a.selectors.map(e)+f(a.rule)+"\n",G&&(E+=a.selectors.map(d)+f(a.rule)+"\n"))});var a=document.createElement("style");a.textContent=E,document.head.appendChild(a)}}function h(){if(!window.PointerEvent){if(window.PointerEvent=a,window.navigator.msPointerEnabled){var b=window.navigator.msMaxTouchPoints;Object.defineProperty(window.navigator,"maxTouchPoints",{value:b,enumerable:!0}),u.registerSource("ms",_)}else Object.defineProperty(window.navigator,"maxTouchPoints",{value:0,enumerable:!0}),u.registerSource("mouse",N),void 0!==window.ontouchstart&&u.registerSource("touch",V);u.register(document)}}function i(a){if(!u.pointermap.has(a)){var b=new Error("InvalidPointerId");throw b.name="InvalidPointerId",b}}function j(a){for(var b=a.parentNode;b&&b!==a.ownerDocument;)b=b.parentNode;if(!b){var c=new Error("InvalidStateError");throw c.name="InvalidStateError",c}}function k(a){var b=u.pointermap.get(a);return 0!==b.buttons}function l(){window.Element&&!Element.prototype.setPointerCapture&&Object.defineProperties(Element.prototype,{setPointerCapture:{value:W},releasePointerCapture:{value:X},hasPointerCapture:{value:Y}})}
var m=["bubbles","cancelable","view","detail","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","pageX","pageY"],n=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0],o=window.Map&&window.Map.prototype.forEach,p=o?Map:b;b.prototype={set:function(a,b){return void 0===b?this["delete"](a):(this.has(a)||this.size++,void(this.array[a]=b))},has:function(a){return void 0!==this.array[a]},"delete":function(a){this.has(a)&&(delete this.array[a],this.size--)},get:function(a){return this.array[a]},clear:function(){this.array.length=0,this.size=0},forEach:function(a,b){return this.array.forEach(function(c,d){a.call(b,c,d,this)},this)}};var q=["bubbles","cancelable","view","detail","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","buttons","pointerId","width","height","pressure","tiltX","tiltY","pointerType","hwTimestamp","isPrimary","type","target","currentTarget","which","pageX","pageY","timeStamp"],r=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0,0,0,0,0,0,"",0,!1,"",null,null,0,0,0,0],s={pointerover:1,pointerout:1,pointerenter:1,pointerleave:1},t="undefined"!=typeof SVGElementInstance,u={pointermap:new p,eventMap:Object.create(null),captureInfo:Object.create(null),eventSources:Object.create(null),eventSourceList:[],registerSource:function(a,b){var c=b,d=c.events;d&&(d.forEach(function(a){c[a]&&(this.eventMap[a]=c[a].bind(c))},this),this.eventSources[a]=c,this.eventSourceList.push(c))},register:function(a){for(var b,c=this.eventSourceList.length,d=0;d<c&&(b=this.eventSourceList[d]);d++)
b.register.call(b,a)},unregister:function(a){for(var b,c=this.eventSourceList.length,d=0;d<c&&(b=this.eventSourceList[d]);d++)
b.unregister.call(b,a)},contains:function(a,b){try{return a.contains(b)}catch(c){return!1}},down:function(a){a.bubbles=!0,this.fireEvent("pointerdown",a)},move:function(a){a.bubbles=!0,this.fireEvent("pointermove",a)},up:function(a){a.bubbles=!0,this.fireEvent("pointerup",a)},enter:function(a){a.bubbles=!1,this.fireEvent("pointerenter",a)},leave:function(a){a.bubbles=!1,this.fireEvent("pointerleave",a)},over:function(a){a.bubbles=!0,this.fireEvent("pointerover",a)},out:function(a){a.bubbles=!0,this.fireEvent("pointerout",a)},cancel:function(a){a.bubbles=!0,this.fireEvent("pointercancel",a)},leaveOut:function(a){this.out(a),this.propagate(a,this.leave,!1)},enterOver:function(a){this.over(a),this.propagate(a,this.enter,!0)},eventHandler:function(a){if(!a._handledByPE){var b=a.type,c=this.eventMap&&this.eventMap[b];c&&c(a),a._handledByPE=!0}},listen:function(a,b){b.forEach(function(b){this.addEvent(a,b)},this)},unlisten:function(a,b){b.forEach(function(b){this.removeEvent(a,b)},this)},addEvent:function(a,b){a.addEventListener(b,this.boundHandler)},removeEvent:function(a,b){a.removeEventListener(b,this.boundHandler)},makeEvent:function(b,c){this.captureInfo[c.pointerId]&&(c.relatedTarget=null);var d=new a(b,c);return c.preventDefault&&(d.preventDefault=c.preventDefault),d._target=d._target||c.target,d},fireEvent:function(a,b){var c=this.makeEvent(a,b);return this.dispatchEvent(c)},cloneEvent:function(a){for(var b,c=Object.create(null),d=0;d<q.length;d++)b=q[d],c[b]=a[b]||r[d],!t||"target"!==b&&"relatedTarget"!==b||c[b]instanceof SVGElementInstance&&(c[b]=c[b].correspondingUseElement);return a.preventDefault&&(c.preventDefault=function(){a.preventDefault()}),c},getTarget:function(a){var b=this.captureInfo[a.pointerId];return b?a._target!==b&&a.type in s?void 0:b:a._target},propagate:function(a,b,c){for(var d=a.target,e=[];d!==document&&!d.contains(a.relatedTarget);) if(e.push(d),d=d.parentNode,!d)return;c&&e.reverse(),e.forEach(function(c){a.target=c,b.call(this,a)},this)},setCapture:function(b,c,d){this.captureInfo[b]&&this.releaseCapture(b,d),this.captureInfo[b]=c,this.implicitRelease=this.releaseCapture.bind(this,b,d),document.addEventListener("pointerup",this.implicitRelease),document.addEventListener("pointercancel",this.implicitRelease);var e=new a("gotpointercapture");e.pointerId=b,e._target=c,d||this.asyncDispatchEvent(e)},releaseCapture:function(b,c){var d=this.captureInfo[b];if(d){this.captureInfo[b]=void 0,document.removeEventListener("pointerup",this.implicitRelease),document.removeEventListener("pointercancel",this.implicitRelease);var e=new a("lostpointercapture");e.pointerId=b,e._target=d,c||this.asyncDispatchEvent(e)}},dispatchEvent:/*scope.external.dispatchEvent || */function(a){var b=this.getTarget(a);if(b)return b.dispatchEvent(a)},asyncDispatchEvent:function(a){requestAnimationFrame(this.dispatchEvent.bind(this,a))}};u.boundHandler=u.eventHandler.bind(u);var v={shadow:function(a){if(a)return a.shadowRoot||a.webkitShadowRoot},canTarget:function(a){return a&&Boolean(a.elementFromPoint)},targetingShadow:function(a){var b=this.shadow(a);if(this.canTarget(b))return b},olderShadow:function(a){var b=a.olderShadowRoot;if(!b){var c=a.querySelector("shadow");c&&(b=c.olderShadowRoot)}return b},allShadows:function(a){for(var b=[],c=this.shadow(a);c;)b.push(c),c=this.olderShadow(c);return b},searchRoot:function(a,b,c){if(a){var d,e,f=a.elementFromPoint(b,c);for(e=this.targetingShadow(f);e;){if(d=e.elementFromPoint(b,c)){var g=this.targetingShadow(d);return this.searchRoot(g,b,c)||d} e=this.olderShadow(e)} return f}},owner:function(a){
for(var b=a;b.parentNode;)b=b.parentNode;
return b.nodeType!==Node.DOCUMENT_NODE&&b.nodeType!==Node.DOCUMENT_FRAGMENT_NODE&&(b=document),b},findTarget:function(a){var b=a.clientX,c=a.clientY,d=this.owner(a.target);
return d.elementFromPoint(b,c)||(d=document),this.searchRoot(d,b,c)}},w=Array.prototype.forEach.call.bind(Array.prototype.forEach),x=Array.prototype.map.call.bind(Array.prototype.map),y=Array.prototype.slice.call.bind(Array.prototype.slice),z=Array.prototype.filter.call.bind(Array.prototype.filter),A=window.MutationObserver||window.WebKitMutationObserver,B="[touch-action]",C={subtree:!0,childList:!0,attributes:!0,attributeOldValue:!0,attributeFilter:["touch-action"]};c.prototype={watchSubtree:function(a){
//
this.observer&&v.canTarget(a)&&this.observer.observe(a,C)},enableOnSubtree:function(a){this.watchSubtree(a),a===document&&"complete"!==document.readyState?this.installOnLoad():this.installNewSubtree(a)},installNewSubtree:function(a){w(this.findElements(a),this.addElement,this)},findElements:function(a){return a.querySelectorAll?a.querySelectorAll(B):[]},removeElement:function(a){this.removeCallback(a)},addElement:function(a){this.addCallback(a)},elementChanged:function(a,b){this.changedCallback(a,b)},concatLists:function(a,b){return a.concat(y(b))},
installOnLoad:function(){document.addEventListener("readystatechange",function(){"complete"===document.readyState&&this.installNewSubtree(document)}.bind(this))},isElement:function(a){return a.nodeType===Node.ELEMENT_NODE},flattenMutationTree:function(a){
var b=x(a,this.findElements,this);
return b.push(z(a,this.isElement)),b.reduce(this.concatLists,[])},mutationWatcher:function(a){a.forEach(this.mutationHandler,this)},mutationHandler:function(a){if("childList"===a.type){var b=this.flattenMutationTree(a.addedNodes);b.forEach(this.addElement,this);var c=this.flattenMutationTree(a.removedNodes);c.forEach(this.removeElement,this)}else"attributes"===a.type&&this.elementChanged(a.target,a.oldValue)}};var D=["none","auto","pan-x","pan-y",{rule:"pan-x pan-y",selectors:["pan-x pan-y","pan-y pan-x"]}],E="",F=window.PointerEvent||window.MSPointerEvent,G=!window.ShadowDOMPolyfill&&document.head.createShadowRoot,H=u.pointermap,I=25,J=[1,4,2,8,16],K=!1;try{K=1===new MouseEvent("test",{buttons:1}).buttons}catch(L){}
var M,N={POINTER_ID:1,POINTER_TYPE:"mouse",events:["mousedown","mousemove","mouseup","mouseover","mouseout"],register:function(a){u.listen(a,this.events)},unregister:function(a){u.unlisten(a,this.events)},lastTouches:[],
isEventSimulatedFromTouch:function(a){for(var b,c=this.lastTouches,d=a.clientX,e=a.clientY,f=0,g=c.length;f<g&&(b=c[f]);f++){
var h=Math.abs(d-b.x),i=Math.abs(e-b.y);if(h<=I&&i<=I)return!0}},prepareEvent:function(a){var b=u.cloneEvent(a),c=b.preventDefault;return b.preventDefault=function(){a.preventDefault(),c()},b.pointerId=this.POINTER_ID,b.isPrimary=!0,b.pointerType=this.POINTER_TYPE,b},prepareButtonsForMove:function(a,b){var c=H.get(this.POINTER_ID);
0!==b.which&&c?a.buttons=c.buttons:a.buttons=0,b.buttons=a.buttons},mousedown:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=H.get(this.POINTER_ID),c=this.prepareEvent(a);K||(c.buttons=J[c.button],b&&(c.buttons|=b.buttons),a.buttons=c.buttons),H.set(this.POINTER_ID,a),b&&0!==b.buttons?u.move(c):u.down(c)}},mousemove:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=this.prepareEvent(a);K||this.prepareButtonsForMove(b,a),b.button=-1,H.set(this.POINTER_ID,a),u.move(b)}},mouseup:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=H.get(this.POINTER_ID),c=this.prepareEvent(a);if(!K){var d=J[c.button];
c.buttons=b?b.buttons&~d:0,a.buttons=c.buttons}H.set(this.POINTER_ID,a),
c.buttons&=~J[c.button],0===c.buttons?u.up(c):u.move(c)}},mouseover:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=this.prepareEvent(a);K||this.prepareButtonsForMove(b,a),b.button=-1,H.set(this.POINTER_ID,a),u.enterOver(b)}},mouseout:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=this.prepareEvent(a);K||this.prepareButtonsForMove(b,a),b.button=-1,u.leaveOut(b)}},cancel:function(a){var b=this.prepareEvent(a);u.cancel(b),this.deactivateMouse()},deactivateMouse:function(){H["delete"](this.POINTER_ID)}},O=u.captureInfo,P=v.findTarget.bind(v),Q=v.allShadows.bind(v),R=u.pointermap,S=2500,T=200,U="touch-action",V={events:["touchstart","touchmove","touchend","touchcancel"],register:function(a){M.enableOnSubtree(a)},unregister:function(){},elementAdded:function(a){var b=a.getAttribute(U),c=this.touchActionToScrollType(b);c&&(a._scrollType=c,u.listen(a,this.events),
Q(a).forEach(function(a){a._scrollType=c,u.listen(a,this.events)},this))},elementRemoved:function(a){a._scrollType=void 0,u.unlisten(a,this.events),
Q(a).forEach(function(a){a._scrollType=void 0,u.unlisten(a,this.events)},this)},elementChanged:function(a,b){var c=a.getAttribute(U),d=this.touchActionToScrollType(c),e=this.touchActionToScrollType(b);
d&&e?(a._scrollType=d,Q(a).forEach(function(a){a._scrollType=d},this)):e?this.elementRemoved(a):d&&this.elementAdded(a)},scrollTypes:{EMITTER:"none",XSCROLLER:"pan-x",YSCROLLER:"pan-y",SCROLLER:/^(?:pan-x pan-y)|(?:pan-y pan-x)|auto$/},touchActionToScrollType:function(a){var b=a,c=this.scrollTypes;return"none"===b?"none":b===c.XSCROLLER?"X":b===c.YSCROLLER?"Y":c.SCROLLER.exec(b)?"XY":void 0},POINTER_TYPE:"touch",firstTouch:null,isPrimaryTouch:function(a){return this.firstTouch===a.identifier},setPrimaryTouch:function(a){
(0===R.size||1===R.size&&R.has(1))&&(this.firstTouch=a.identifier,this.firstXY={X:a.clientX,Y:a.clientY},this.scrolling=!1,this.cancelResetClickCount())},removePrimaryPointer:function(a){a.isPrimary&&(this.firstTouch=null,this.firstXY=null,this.resetClickCount())},clickCount:0,resetId:null,resetClickCount:function(){var a=function(){this.clickCount=0,this.resetId=null}.bind(this);this.resetId=setTimeout(a,T)},cancelResetClickCount:function(){this.resetId&&clearTimeout(this.resetId)},typeToButtons:function(a){var b=0;return"touchstart"!==a&&"touchmove"!==a||(b=1),b},touchToPointer:function(a){var b=this.currentTouchEvent,c=u.cloneEvent(a),d=c.pointerId=a.identifier+2;c.target=O[d]||P(c),c.bubbles=!0,c.cancelable=!0,c.detail=this.clickCount,c.button=0,c.buttons=this.typeToButtons(b.type),c.width=2*(a.radiusX||a.webkitRadiusX||0),c.height=2*(a.radiusY||a.webkitRadiusY||0),c.pressure=a.force||a.webkitForce||.5,c.isPrimary=this.isPrimaryTouch(a),c.pointerType=this.POINTER_TYPE,
c.altKey=b.altKey,c.ctrlKey=b.ctrlKey,c.metaKey=b.metaKey,c.shiftKey=b.shiftKey;
var e=this;return c.preventDefault=function(){e.scrolling=!1,e.firstXY=null,b.preventDefault()},c},processTouches:function(a,b){var c=a.changedTouches;this.currentTouchEvent=a;for(var d,e=0;e<c.length;e++)d=c[e],b.call(this,this.touchToPointer(d))},
shouldScroll:function(a){if(this.firstXY){var b,c=a.currentTarget._scrollType;if("none"===c)
b=!1;else if("XY"===c)
b=!0;else{var d=a.changedTouches[0],e=c,f="Y"===c?"X":"Y",g=Math.abs(d["client"+e]-this.firstXY[e]),h=Math.abs(d["client"+f]-this.firstXY[f]);
b=g>=h}return this.firstXY=null,b}},findTouch:function(a,b){for(var c,d=0,e=a.length;d<e&&(c=a[d]);d++)if(c.identifier===b)return!0},
vacuumTouches:function(a){var b=a.touches;
if(R.size>=b.length){var c=[];R.forEach(function(a,d){
if(1!==d&&!this.findTouch(b,d-2)){var e=a.out;c.push(e)}},this),c.forEach(this.cancelOut,this)}},touchstart:function(a){this.vacuumTouches(a),this.setPrimaryTouch(a.changedTouches[0]),this.dedupSynthMouse(a),this.scrolling||(this.clickCount++,this.processTouches(a,this.overDown))},overDown:function(a){R.set(a.pointerId,{target:a.target,out:a,outTarget:a.target}),u.enterOver(a),u.down(a)},touchmove:function(a){this.scrolling||(this.shouldScroll(a)?(this.scrolling=!0,this.touchcancel(a)):(a.preventDefault(),this.processTouches(a,this.moveOverOut)))},moveOverOut:function(a){var b=a,c=R.get(b.pointerId);
if(c){var d=c.out,e=c.outTarget;u.move(b),d&&e!==b.target&&(d.relatedTarget=b.target,b.relatedTarget=e,
d.target=e,b.target?(u.leaveOut(d),u.enterOver(b)):(
b.target=e,b.relatedTarget=null,this.cancelOut(b))),c.out=b,c.outTarget=b.target}},touchend:function(a){this.dedupSynthMouse(a),this.processTouches(a,this.upOut)},upOut:function(a){this.scrolling||(u.up(a),u.leaveOut(a)),this.cleanUpPointer(a)},touchcancel:function(a){this.processTouches(a,this.cancelOut)},cancelOut:function(a){u.cancel(a),u.leaveOut(a),this.cleanUpPointer(a)},cleanUpPointer:function(a){R["delete"](a.pointerId),this.removePrimaryPointer(a)},
dedupSynthMouse:function(a){var b=N.lastTouches,c=a.changedTouches[0];
if(this.isPrimaryTouch(c)){
var d={x:c.clientX,y:c.clientY};b.push(d);var e=function(a,b){var c=a.indexOf(b);c>-1&&a.splice(c,1)}.bind(null,b,d);setTimeout(e,S)}}};M=new c(V.elementAdded,V.elementRemoved,V.elementChanged,V);var W,X,Y,Z=u.pointermap,$=window.MSPointerEvent&&"number"==typeof window.MSPointerEvent.MSPOINTER_TYPE_MOUSE,_={events:["MSPointerDown","MSPointerMove","MSPointerUp","MSPointerOut","MSPointerOver","MSPointerCancel","MSGotPointerCapture","MSLostPointerCapture"],register:function(a){u.listen(a,this.events)},unregister:function(a){u.unlisten(a,this.events)},POINTER_TYPES:["","unavailable","touch","pen","mouse"],prepareEvent:function(a){var b=a;return $&&(b=u.cloneEvent(a),b.pointerType=this.POINTER_TYPES[a.pointerType]),b},cleanup:function(a){Z["delete"](a)},MSPointerDown:function(a){Z.set(a.pointerId,a);var b=this.prepareEvent(a);u.down(b)},MSPointerMove:function(a){var b=this.prepareEvent(a);u.move(b)},MSPointerUp:function(a){var b=this.prepareEvent(a);u.up(b),this.cleanup(a.pointerId)},MSPointerOut:function(a){var b=this.prepareEvent(a);u.leaveOut(b)},MSPointerOver:function(a){var b=this.prepareEvent(a);u.enterOver(b)},MSPointerCancel:function(a){var b=this.prepareEvent(a);u.cancel(b),this.cleanup(a.pointerId)},MSLostPointerCapture:function(a){var b=u.makeEvent("lostpointercapture",a);u.dispatchEvent(b)},MSGotPointerCapture:function(a){var b=u.makeEvent("gotpointercapture",a);u.dispatchEvent(b)}},aa=window.navigator;aa.msPointerEnabled?(W=function(a){i(a),j(this),k(a)&&(u.setCapture(a,this,!0),this.msSetPointerCapture(a))},X=function(a){i(a),u.releaseCapture(a,!0),this.msReleasePointerCapture(a)}):(W=function(a){i(a),j(this),k(a)&&u.setCapture(a,this)},X=function(a){i(a),u.releaseCapture(a)}),Y=function(a){return!!u.captureInfo[a]},g(),h(),l();var ba={dispatcher:u,Installer:c,PointerEvent:a,PointerMap:p,targetFinding:v};return ba});

///////////////////////////////////////////////

///////////////////////////////////////////////
var config = {"dark_mode": false, "show_pads": true, "show_fabrication": false, "show_silkscreen": true, "highlight_pin1": "none", "redraw_on_drag": true, "board_rotation": 0, "checkboxes": "Sourced,Placed", "bom_view": "left-right", "layer_view": "FB", "offset_back_rotation": false, "kicad_text_formatting": true, "fields": ["Value", "Footprint", "MPN", "Manufacturer"]}
///////////////////////////////////////////////

///////////////////////////////////////////////
var pcbdata = JSON.parse(LZString.decompressFromBase64("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"))
///////////////////////////////////////////////

///////////////////////////////////////////////
/* Utility functions */

var storagePrefix = 'KiCad_HTML_BOM__' + pcbdata.metadata.title + '__' +
  pcbdata.metadata.revision + '__#';
var storage;

function initStorage(key) {
  try {
    window.localStorage.getItem("blank");
    storage = window.localStorage;
  } catch (e) {
    // localStorage not available
  }
  if (!storage) {
    try {
      window.sessionStorage.getItem("blank");
      storage = window.sessionStorage;
    } catch (e) {
      // sessionStorage also not available
    }
  }
}

function readStorage(key) {
  if (storage) {
    return storage.getItem(storagePrefix + key);
  } else {
    return null;
  }
}

function writeStorage(key, value) {
  if (storage) {
    storage.setItem(storagePrefix + key, value);
  }
}

function fancyDblClickHandler(el, onsingle, ondouble) {
  return function () {
    if (el.getAttribute("data-dblclick") == null) {
      el.setAttribute("data-dblclick", 1);
      setTimeout(function () {
        if (el.getAttribute("data-dblclick") == 1) {
          onsingle();
        }
        el.removeAttribute("data-dblclick");
      }, 200);
    } else {
      el.removeAttribute("data-dblclick");
      ondouble();
    }
  }
}

function smoothScrollToRow(rowid) {
  document.getElementById(rowid).scrollIntoView({
    behavior: "smooth",
    block: "center",
    inline: "nearest"
  });
}

function focusInputField(input) {
  input.scrollIntoView(false);
  input.focus();
  input.select();
}

function saveBomTable(output) {
  var text = '';
  for (var node of bomhead.childNodes[0].childNodes) {
    if (node.firstChild) {
      text += (output == 'csv' ? `"${node.firstChild.nodeValue}"` : node.firstChild.nodeValue);
    }
    if (node != bomhead.childNodes[0].lastChild) {
      text += (output == 'csv' ? ',' : '\t');
    }
  }
  text += '\n';
  for (var row of bombody.childNodes) {
    for (var cell of row.childNodes) {
      let val = '';
      for (var node of cell.childNodes) {
        if (node.nodeName == "INPUT") {
          if (node.checked) {
            val += '';
          }
        } else if ((node.nodeName == "MARK") || (node.nodeName == "A")) {
          val += node.firstChild.nodeValue;
        } else {
          val += node.nodeValue;
        }
      }
      if (output == 'csv') {
        val = val.replace(/\"/g, '\"\"'); // pair of double-quote characters
        if (isNumeric(val)) {
          val = +val;                     // use number
        } else {
          val = `"${val}"`;               // enclosed within double-quote
        }
      }
      text += val;
      if (cell != row.lastChild) {
        text += (output == 'csv' ? ',' : '\t');
      }
    }
    text += '\n';
  }

  if (output != 'clipboard') {
    // To file: csv or txt
    var blob = new Blob([text], {
      type: `text/${output}`
    });
    saveFile(`${pcbdata.metadata.title}.${output}`, blob);
  } else {
    // To clipboard
    var textArea = document.createElement("textarea");
    textArea.classList.add('clipboard-temp');
    textArea.value = text;

    document.body.appendChild(textArea);
    textArea.focus();
    textArea.select();

    try {
      if (document.execCommand('copy')) {
        console.log('Bom copied to clipboard.');
      }
    } catch (err) {
      console.log('Can not copy to clipboard.');
    }

    document.body.removeChild(textArea);
  }
}

function isNumeric(str) {
  /* https://stackoverflow.com/a/175787 */
  return (typeof str != "string" ? false : !isNaN(str) && !isNaN(parseFloat(str)));
}

function removeGutterNode(node) {
  for (var i = 0; i < node.childNodes.length; i++) {
    if (node.childNodes[i].classList &&
      node.childNodes[i].classList.contains("gutter")) {
      node.removeChild(node.childNodes[i]);
      break;
    }
  }
}

function cleanGutters() {
  removeGutterNode(document.getElementById("bot"));
  removeGutterNode(document.getElementById("canvasdiv"));
}

var units = {
  prefixes: {
    giga: ["G", "g", "giga", "Giga", "GIGA"],
    mega: ["M", "mega", "Mega", "MEGA"],
    kilo: ["K", "k", "kilo", "Kilo", "KILO"],
    milli: ["m", "milli", "Milli", "MILLI"],
    micro: ["U", "u", "micro", "Micro", "MICRO", "", ""], // different utf8 
    nano: ["N", "n", "nano", "Nano", "NANO"],
    pico: ["P", "p", "pico", "Pico", "PICO"],
  },
  unitsShort: ["R", "r", "", "F", "f", "H", "h"],
  unitsLong: [
    "OHM", "Ohm", "ohm", "ohms",
    "FARAD", "Farad", "farad",
    "HENRY", "Henry", "henry"
  ],
  getMultiplier: function (s) {
    if (this.prefixes.giga.includes(s)) return 1e9;
    if (this.prefixes.mega.includes(s)) return 1e6;
    if (this.prefixes.kilo.includes(s)) return 1e3;
    if (this.prefixes.milli.includes(s)) return 1e-3;
    if (this.prefixes.micro.includes(s)) return 1e-6;
    if (this.prefixes.nano.includes(s)) return 1e-9;
    if (this.prefixes.pico.includes(s)) return 1e-12;
    return 1;
  },
  valueRegex: null,
}

function initUtils() {
  var allPrefixes = units.prefixes.giga
    .concat(units.prefixes.mega)
    .concat(units.prefixes.kilo)
    .concat(units.prefixes.milli)
    .concat(units.prefixes.micro)
    .concat(units.prefixes.nano)
    .concat(units.prefixes.pico);
  var allUnits = units.unitsShort.concat(units.unitsLong);
  units.valueRegex = new RegExp("^([0-9\.]+)" +
    "\\s*(" + allPrefixes.join("|") + ")?" +
    "(" + allUnits.join("|") + ")?" +
    "(\\b.*)?$", "");
  units.valueAltRegex = new RegExp("^([0-9]*)" +
    "(" + units.unitsShort.join("|") + ")?" +
    "([GgMmKkUuNnPp])?" +
    "([0-9]*)" +
    "(\\b.*)?$", "");
  if (config.fields.includes("Value")) {
    var index = config.fields.indexOf("Value");
    pcbdata.bom["parsedValues"] = {};
    for (var id in pcbdata.bom.fields) {
      pcbdata.bom.parsedValues[id] = parseValue(pcbdata.bom.fields[id][index])
    }
  }
}

function parseValue(val, ref) {
  var inferUnit = (unit, ref) => {
    if (unit) {
      unit = unit.toLowerCase();
      if (unit == '' || unit == "ohm" || unit == "ohms") {
        unit = 'r';
      }
      unit = unit[0];
    } else {
      ref = /^([a-z]+)\d+$/i.exec(ref);
      if (ref) {
        ref = ref[1].toLowerCase();
        if (ref == "c") unit = 'f';
        else if (ref == "l") unit = 'h';
        else if (ref == "r" || ref == "rv") unit = 'r';
        else unit = null;
      }
    }
    return unit;
  };
  val = val.replace(/,/g, "");
  var match = units.valueRegex.exec(val);
  var unit;
  if (match) {
    val = parseFloat(match[1]);
    if (match[2]) {
      val = val * units.getMultiplier(match[2]);
    }
    unit = inferUnit(match[3], ref);
    if (!unit) return null;
    else return {
      val: val,
      unit: unit,
      extra: match[4],
    }
  }
  match = units.valueAltRegex.exec(val);
  if (match && (match[1] || match[4])) {
    val = parseFloat(match[1] + "." + match[4]);
    if (match[3]) {
      val = val * units.getMultiplier(match[3]);
    }
    unit = inferUnit(match[2], ref);
    if (!unit) return null;
    else return {
      val: val,
      unit: unit,
      extra: match[5],
    }
  }
  return null;
}

function valueCompare(a, b, stra, strb) {
  if (a === null && b === null) {
    // Failed to parse both values, compare them as strings.
    if (stra != strb) return stra > strb ? 1 : -1;
    else return 0;
  } else if (a === null) {
    return 1;
  } else if (b === null) {
    return -1;
  } else {
    if (a.unit != b.unit) return a.unit > b.unit ? 1 : -1;
    else if (a.val != b.val) return a.val > b.val ? 1 : -1;
    else if (a.extra != b.extra) return a.extra > b.extra ? 1 : -1;
    else return 0;
  }
}

function validateSaveImgDimension(element) {
  var valid = false;
  var intValue = 0;
  if (/^[1-9]\d*$/.test(element.value)) {
    intValue = parseInt(element.value);
    if (intValue <= 16000) {
      valid = true;
    }
  }
  if (valid) {
    element.classList.remove("invalid");
  } else {
    element.classList.add("invalid");
  }
  return intValue;
}

function saveImage(layer) {
  var width = validateSaveImgDimension(document.getElementById("render-save-width"));
  var height = validateSaveImgDimension(document.getElementById("render-save-height"));
  var bgcolor = null;
  if (!document.getElementById("render-save-transparent").checked) {
    var style = getComputedStyle(topmostdiv);
    bgcolor = style.getPropertyValue("background-color");
  }
  if (!width || !height) return;

  // Prepare image
  var canvas = document.createElement("canvas");
  var layerdict = {
    transform: {
      x: 0,
      y: 0,
      s: 1,
      panx: 0,
      pany: 0,
      zoom: 1,
    },
    bg: canvas,
    fab: canvas,
    silk: canvas,
    highlight: canvas,
    layer: layer,
  }
  // Do the rendering
  recalcLayerScale(layerdict, width, height);
  prepareLayer(layerdict);
  clearCanvas(canvas, bgcolor);
  drawBackground(layerdict, false);
  drawHighlightsOnLayer(layerdict, false);

  // Save image
  var imgdata = canvas.toDataURL("image/png");

  var filename = pcbdata.metadata.title;
  if (pcbdata.metadata.revision) {
    filename += `.${pcbdata.metadata.revision}`;
  }
  filename += `.${layer}.png`;
  saveFile(filename, dataURLtoBlob(imgdata));
}

function saveSettings() {
  var data = {
    type: "InteractiveHtmlBom settings",
    version: 1,
    pcbmetadata: pcbdata.metadata,
    settings: settings,
  }
  var blob = new Blob([JSON.stringify(data, null, 4)], {
    type: "application/json"
  });
  saveFile(`${pcbdata.metadata.title}.settings.json`, blob);
}

function loadSettings() {
  var input = document.createElement("input");
  input.type = "file";
  input.accept = ".settings.json";
  input.onchange = function (e) {
    var file = e.target.files[0];
    var reader = new FileReader();
    reader.onload = readerEvent => {
      var content = readerEvent.target.result;
      var newSettings;
      try {
        newSettings = JSON.parse(content);
      } catch (e) {
        alert("Selected file is not InteractiveHtmlBom settings file.");
        return;
      }
      if (newSettings.type != "InteractiveHtmlBom settings") {
        alert("Selected file is not InteractiveHtmlBom settings file.");
        return;
      }
      var metadataMatches = newSettings.hasOwnProperty("pcbmetadata");
      if (metadataMatches) {
        for (var k in pcbdata.metadata) {
          if (!newSettings.pcbmetadata.hasOwnProperty(k) || newSettings.pcbmetadata[k] != pcbdata.metadata[k]) {
            metadataMatches = false;
          }
        }
      }
      if (!metadataMatches) {
        var currentMetadata = JSON.stringify(pcbdata.metadata, null, 4);
        var fileMetadata = JSON.stringify(newSettings.pcbmetadata, null, 4);
        if (!confirm(
          `Settins file metadata does not match current metadata.\n\n` +
          `Page metadata:\n${currentMetadata}\n\n` +
          `Settings file metadata:\n${fileMetadata}\n\n` +
          `Press OK if you would like to import settings anyway.`)) {
          return;
        }
      }
      overwriteSettings(newSettings.settings);
    }
    reader.readAsText(file, 'UTF-8');
  }
  input.click();
}

function resetSettings() {
  if (!confirm(
    `This will reset all checkbox states and other settings.\n\n` +
    `Press OK if you want to continue.`)) {
    return;
  }
  if (storage) {
    var keys = [];
    for (var i = 0; i < storage.length; i++) {
      var key = storage.key(i);
      if (key.startsWith(storagePrefix)) keys.push(key);
    }
    for (var key of keys) storage.removeItem(key);
  }
  location.reload();
}

function overwriteSettings(newSettings) {
  initDone = false;
  Object.assign(settings, newSettings);
  writeStorage("bomlayout", settings.bomlayout);
  writeStorage("bommode", settings.bommode);
  writeStorage("canvaslayout", settings.canvaslayout);
  writeStorage("bomCheckboxes", settings.checkboxes.join(","));
  document.getElementById("bomCheckboxes").value = settings.checkboxes.join(",");
  for (var checkbox of settings.checkboxes) {
    writeStorage("checkbox_" + checkbox, settings.checkboxStoredRefs[checkbox]);
  }
  writeStorage("markWhenChecked", settings.markWhenChecked);
  padsVisible(settings.renderPads);
  document.getElementById("padsCheckbox").checked = settings.renderPads;
  fabricationVisible(settings.renderFabrication);
  document.getElementById("fabricationCheckbox").checked = settings.renderFabrication;
  silkscreenVisible(settings.renderSilkscreen);
  document.getElementById("silkscreenCheckbox").checked = settings.renderSilkscreen;
  referencesVisible(settings.renderReferences);
  document.getElementById("referencesCheckbox").checked = settings.renderReferences;
  valuesVisible(settings.renderValues);
  document.getElementById("valuesCheckbox").checked = settings.renderValues;
  tracksVisible(settings.renderTracks);
  document.getElementById("tracksCheckbox").checked = settings.renderTracks;
  zonesVisible(settings.renderZones);
  document.getElementById("zonesCheckbox").checked = settings.renderZones;
  dnpOutline(settings.renderDnpOutline);
  document.getElementById("dnpOutlineCheckbox").checked = settings.renderDnpOutline;
  setRedrawOnDrag(settings.redrawOnDrag);
  document.getElementById("dragCheckbox").checked = settings.redrawOnDrag;
  setDarkMode(settings.darkMode);
  document.getElementById("darkmodeCheckbox").checked = settings.darkMode;
  setHighlightPin1(settings.highlightpin1);
  document.forms.highlightpin1.highlightpin1.value = settings.highlightpin1;
  writeStorage("boardRotation", settings.boardRotation);
  document.getElementById("boardRotation").value = settings.boardRotation / 5;
  document.getElementById("rotationDegree").textContent = settings.boardRotation;
  setOffsetBackRotation(settings.offsetBackRotation);
  document.getElementById("offsetBackRotationCheckbox").checked = settings.offsetBackRotation;
  initDone = true;
  prepCheckboxes();
  changeBomLayout(settings.bomlayout);
}

function saveFile(filename, blob) {
  var link = document.createElement("a");
  var objurl = URL.createObjectURL(blob);
  link.download = filename;
  link.href = objurl;
  link.click();
}

function dataURLtoBlob(dataurl) {
  var arr = dataurl.split(','),
    mime = arr[0].match(/:(.*?);/)[1],
    bstr = atob(arr[1]),
    n = bstr.length,
    u8arr = new Uint8Array(n);
  while (n--) {
    u8arr[n] = bstr.charCodeAt(n);
  }
  return new Blob([u8arr], {
    type: mime
  });
}

var settings = {
  canvaslayout: "FB",
  bomlayout: "left-right",
  bommode: "grouped",
  checkboxes: [],
  checkboxStoredRefs: {},
  darkMode: false,
  highlightpin1: "none",
  redrawOnDrag: true,
  boardRotation: 0,
  offsetBackRotation: false,
  renderPads: true,
  renderReferences: true,
  renderValues: true,
  renderSilkscreen: true,
  renderFabrication: true,
  renderDnpOutline: false,
  renderTracks: true,
  renderZones: true,
  columnOrder: [],
  hiddenColumns: [],
  netColors: {},
}

function initDefaults() {
  settings.bomlayout = readStorage("bomlayout");
  if (settings.bomlayout === null) {
    settings.bomlayout = config.bom_view;
  }
  if (!['bom-only', 'left-right', 'top-bottom'].includes(settings.bomlayout)) {
    settings.bomlayout = config.bom_view;
  }
  settings.bommode = readStorage("bommode");
  if (settings.bommode === null) {
    settings.bommode = "grouped";
  }
  if (settings.bommode == "netlist" && !pcbdata.nets) {
    settings.bommode = "grouped";
  }
  if (!["grouped", "ungrouped", "netlist"].includes(settings.bommode)) {
    settings.bommode = "grouped";
  }
  settings.canvaslayout = readStorage("canvaslayout");
  if (settings.canvaslayout === null) {
    settings.canvaslayout = config.layer_view;
  }
  var bomCheckboxes = readStorage("bomCheckboxes");
  if (bomCheckboxes === null) {
    bomCheckboxes = config.checkboxes;
  }
  settings.checkboxes = bomCheckboxes.split(",").filter((e) => e);
  document.getElementById("bomCheckboxes").value = bomCheckboxes;

  var highlightpin1 = readStorage("highlightpin1") || config.highlight_pin1;
  if (highlightpin1 === "false") highlightpin1 = "none";
  if (highlightpin1 === "true") highlightpin1 = "all";
  setHighlightPin1(highlightpin1);
  document.forms.highlightpin1.highlightpin1.value = highlightpin1;

  settings.markWhenChecked = readStorage("markWhenChecked") || "";
  populateMarkWhenCheckedOptions();

  function initBooleanSetting(storageString, def, elementId, func) {
    var b = readStorage(storageString);
    if (b === null) {
      b = def;
    } else {
      b = (b == "true");
    }
    document.getElementById(elementId).checked = b;
    func(b);
  }

  initBooleanSetting("padsVisible", config.show_pads, "padsCheckbox", padsVisible);
  initBooleanSetting("fabricationVisible", config.show_fabrication, "fabricationCheckbox", fabricationVisible);
  initBooleanSetting("silkscreenVisible", config.show_silkscreen, "silkscreenCheckbox", silkscreenVisible);
  initBooleanSetting("referencesVisible", true, "referencesCheckbox", referencesVisible);
  initBooleanSetting("valuesVisible", true, "valuesCheckbox", valuesVisible);
  if ("tracks" in pcbdata) {
    initBooleanSetting("tracksVisible", true, "tracksCheckbox", tracksVisible);
    initBooleanSetting("zonesVisible", true, "zonesCheckbox", zonesVisible);
  } else {
    document.getElementById("tracksAndZonesCheckboxes").style.display = "none";
    tracksVisible(false);
    zonesVisible(false);
  }
  initBooleanSetting("dnpOutline", false, "dnpOutlineCheckbox", dnpOutline);
  initBooleanSetting("redrawOnDrag", config.redraw_on_drag, "dragCheckbox", setRedrawOnDrag);
  initBooleanSetting("darkmode", config.dark_mode, "darkmodeCheckbox", setDarkMode);

  var fields = ["checkboxes", "References"].concat(config.fields).concat(["Quantity"]);
  var hcols = JSON.parse(readStorage("hiddenColumns"));
  if (hcols === null) {
    hcols = [];
  }
  settings.hiddenColumns = hcols.filter(e => fields.includes(e));

  var cord = JSON.parse(readStorage("columnOrder"));
  if (cord === null) {
    cord = fields;
  } else {
    cord = cord.filter(e => fields.includes(e));
    if (cord.length != fields.length)
      cord = fields;
  }
  settings.columnOrder = cord;

  settings.boardRotation = readStorage("boardRotation");
  if (settings.boardRotation === null) {
    settings.boardRotation = config.board_rotation * 5;
  } else {
    settings.boardRotation = parseInt(settings.boardRotation);
  }
  document.getElementById("boardRotation").value = settings.boardRotation / 5;
  document.getElementById("rotationDegree").textContent = settings.boardRotation;
  initBooleanSetting("offsetBackRotation", config.offset_back_rotation, "offsetBackRotationCheckbox", setOffsetBackRotation);

  settings.netColors = JSON.parse(readStorage("netColors")) || {};
}

// Helper classes for user js callbacks.

const IBOM_EVENT_TYPES = {
  ALL: "all",
  HIGHLIGHT_EVENT: "highlightEvent",
  CHECKBOX_CHANGE_EVENT: "checkboxChangeEvent",
  BOM_BODY_CHANGE_EVENT: "bomBodyChangeEvent",
}

const EventHandler = {
  callbacks: {},
  init: function () {
    for (eventType of Object.values(IBOM_EVENT_TYPES))
      this.callbacks[eventType] = [];
  },
  registerCallback: function (eventType, callback) {
    this.callbacks[eventType].push(callback);
  },
  emitEvent: function (eventType, eventArgs) {
    event = {
      eventType: eventType,
      args: eventArgs,
    }
    var callback;
    for (callback of this.callbacks[eventType])
      callback(event);
    for (callback of this.callbacks[IBOM_EVENT_TYPES.ALL])
      callback(event);
  }
}
EventHandler.init();

///////////////////////////////////////////////

///////////////////////////////////////////////
/* PCB rendering code */

var emptyContext2d = document.createElement("canvas").getContext("2d");

function deg2rad(deg) {
  return deg * Math.PI / 180;
}

function calcFontPoint(linepoint, text, offsetx, offsety, tilt) {
  var point = [
    linepoint[0] * text.width + offsetx,
    linepoint[1] * text.height + offsety
  ];
  // This approximates pcbnew behavior with how text tilts depending on horizontal justification
  point[0] -= (linepoint[1] + 0.5 * (1 + text.justify[0])) * text.height * tilt;
  return point;
}

function drawText(ctx, text, color) {
  if ("ref" in text && !settings.renderReferences) return;
  if ("val" in text && !settings.renderValues) return;
  ctx.save();
  ctx.fillStyle = color;
  ctx.strokeStyle = color;
  ctx.lineCap = "round";
  ctx.lineJoin = "round";
  ctx.lineWidth = text.thickness;
  if ("svgpath" in text) {
    ctx.stroke(new Path2D(text.svgpath));
    ctx.restore();
    return;
  }
  if ("polygons" in text) {
    ctx.fill(getPolygonsPath(text));
    ctx.restore();
    return;
  }
  ctx.translate(...text.pos);
  ctx.translate(text.thickness * 0.5, 0);
  var angle = -text.angle;
  if (text.attr.includes("mirrored")) {
    ctx.scale(-1, 1);
    angle = -angle;
  }
  var tilt = 0;
  if (text.attr.includes("italic")) {
    tilt = 0.125;
  }
  var interline = text.height * 1.5 + text.thickness;
  var txt = text.text.split("\n");
  // KiCad ignores last empty line.
  if (txt[txt.length - 1] == '') txt.pop();
  ctx.rotate(deg2rad(angle));
  var offsety = (1 - text.justify[1]) / 2 * text.height; // One line offset
  offsety -= (txt.length - 1) * (text.justify[1] + 1) / 2 * interline; // Multiline offset
  for (var i in txt) {
    var lineWidth = text.thickness + interline / 2 * tilt;
    for (var j = 0; j < txt[i].length; j++) {
      if (txt[i][j] == '\t') {
        var fourSpaces = 4 * pcbdata.font_data[' '].w * text.width;
        lineWidth += fourSpaces - lineWidth % fourSpaces;
      } else {
        if (txt[i][j] == '~') {
          j++;
          if (j == txt[i].length)
            break;
        }
        lineWidth += pcbdata.font_data[txt[i][j]].w * text.width;
      }
    }
    var offsetx = -lineWidth * (text.justify[0] + 1) / 2;
    var inOverbar = false;
    for (var j = 0; j < txt[i].length; j++) {
      if (config.kicad_text_formatting) {
        if (txt[i][j] == '\t') {
          var fourSpaces = 4 * pcbdata.font_data[' '].w * text.width;
          offsetx += fourSpaces - offsetx % fourSpaces;
          continue;
        } else if (txt[i][j] == '~') {
          j++;
          if (j == txt[i].length)
            break;
          if (txt[i][j] != '~') {
            inOverbar = !inOverbar;
          }
        }
      }
      var glyph = pcbdata.font_data[txt[i][j]];
      if (inOverbar) {
        var overbarStart = [offsetx, -text.height * 1.4 + offsety];
        var overbarEnd = [offsetx + text.width * glyph.w, overbarStart[1]];

        if (!lastHadOverbar) {
          overbarStart[0] += text.height * 1.4 * tilt;
          lastHadOverbar = true;
        }
        ctx.beginPath();
        ctx.moveTo(...overbarStart);
        ctx.lineTo(...overbarEnd);
        ctx.stroke();
      } else {
        lastHadOverbar = false;
      }
      for (var line of glyph.l) {
        ctx.beginPath();
        ctx.moveTo(...calcFontPoint(line[0], text, offsetx, offsety, tilt));
        for (var k = 1; k < line.length; k++) {
          ctx.lineTo(...calcFontPoint(line[k], text, offsetx, offsety, tilt));
        }
        ctx.stroke();
      }
      offsetx += glyph.w * text.width;
    }
    offsety += interline;
  }
  ctx.restore();
}

function drawedge(ctx, scalefactor, edge, color) {
  ctx.strokeStyle = color;
  ctx.fillStyle = color;
  ctx.lineWidth = Math.max(1 / scalefactor, edge.width);
  ctx.lineCap = "round";
  ctx.lineJoin = "round";
  if ("svgpath" in edge) {
    ctx.stroke(new Path2D(edge.svgpath));
  } else {
    ctx.beginPath();
    if (edge.type == "segment") {
      ctx.moveTo(...edge.start);
      ctx.lineTo(...edge.end);
    }
    if (edge.type == "rect") {
      ctx.moveTo(...edge.start);
      ctx.lineTo(edge.start[0], edge.end[1]);
      ctx.lineTo(...edge.end);
      ctx.lineTo(edge.end[0], edge.start[1]);
      ctx.lineTo(...edge.start);
    }
    if (edge.type == "arc") {
      ctx.arc(
        ...edge.start,
        edge.radius,
        deg2rad(edge.startangle),
        deg2rad(edge.endangle));
    }
    if (edge.type == "circle") {
      ctx.arc(
        ...edge.start,
        edge.radius,
        0, 2 * Math.PI);
      ctx.closePath();
    }
    if (edge.type == "curve") {
      ctx.moveTo(...edge.start);
      ctx.bezierCurveTo(...edge.cpa, ...edge.cpb, ...edge.end);
    }
    if("filled" in edge && edge.filled)
      ctx.fill();
    else
      ctx.stroke();
  }
}

function getChamferedRectPath(size, radius, chamfpos, chamfratio) {
  // chamfpos is a bitmask, left = 1, right = 2, bottom left = 4, bottom right = 8
  var path = new Path2D();
  var width = size[0];
  var height = size[1];
  var x = width * -0.5;
  var y = height * -0.5;
  var chamfOffset = Math.min(width, height) * chamfratio;
  path.moveTo(x, 0);
  if (chamfpos & 4) {
    path.lineTo(x, y + height - chamfOffset);
    path.lineTo(x + chamfOffset, y + height);
    path.lineTo(0, y + height);
  } else {
    path.arcTo(x, y + height, x + width, y + height, radius);
  }
  if (chamfpos & 8) {
    path.lineTo(x + width - chamfOffset, y + height);
    path.lineTo(x + width, y + height - chamfOffset);
    path.lineTo(x + width, 0);
  } else {
    path.arcTo(x + width, y + height, x + width, y, radius);
  }
  if (chamfpos & 2) {
    path.lineTo(x + width, y + chamfOffset);
    path.lineTo(x + width - chamfOffset, y);
    path.lineTo(0, y);
  } else {
    path.arcTo(x + width, y, x, y, radius);
  }
  if (chamfpos & 1) {
    path.lineTo(x + chamfOffset, y);
    path.lineTo(x, y + chamfOffset);
    path.lineTo(x, 0);
  } else {
    path.arcTo(x, y, x, y + height, radius);
  }
  path.closePath();
  return path;
}

function getOblongPath(size) {
  return getChamferedRectPath(size, Math.min(size[0], size[1]) / 2, 0, 0);
}

function getPolygonsPath(shape) {
  if (shape.path2d) {
    return shape.path2d;
  }
  if ("svgpath" in shape) {
    shape.path2d = new Path2D(shape.svgpath);
  } else {
    var path = new Path2D();
    for (var polygon of shape.polygons) {
      path.moveTo(...polygon[0]);
      for (var i = 1; i < polygon.length; i++) {
        path.lineTo(...polygon[i]);
      }
      path.closePath();
    }
    shape.path2d = path;
  }
  return shape.path2d;
}

function drawPolygonShape(ctx, scalefactor, shape, color) {
  ctx.save();
  if (!("svgpath" in shape)) {
    ctx.translate(...shape.pos);
    ctx.rotate(deg2rad(-shape.angle));
  }
  if("filled" in shape && !shape.filled) {
    ctx.strokeStyle = color;
    ctx.lineWidth = Math.max(1 / scalefactor, shape.width);
    ctx.lineCap = "round";
    ctx.lineJoin = "round";
    ctx.stroke(getPolygonsPath(shape));
  } else {
    ctx.fillStyle = color;
    ctx.fill(getPolygonsPath(shape));
  }
  ctx.restore();
}

function drawDrawing(ctx, scalefactor, drawing, color) {
  if (["segment", "arc", "circle", "curve", "rect"].includes(drawing.type)) {
    drawedge(ctx, scalefactor, drawing, color);
  } else if (drawing.type == "polygon") {
    drawPolygonShape(ctx, scalefactor, drawing, color);
  } else {
    drawText(ctx, drawing, color);
  }
}

function getCirclePath(radius) {
  var path = new Path2D();
  path.arc(0, 0, radius, 0, 2 * Math.PI);
  path.closePath();
  return path;
}

function getCachedPadPath(pad) {
  if (!pad.path2d) {
    // if path2d is not set, build one and cache it on pad object
    if (pad.shape == "rect") {
      pad.path2d = new Path2D();
      pad.path2d.rect(...pad.size.map(c => -c * 0.5), ...pad.size);
    } else if (pad.shape == "oval") {
      pad.path2d = getOblongPath(pad.size);
    } else if (pad.shape == "circle") {
      pad.path2d = getCirclePath(pad.size[0] / 2);
    } else if (pad.shape == "roundrect") {
      pad.path2d = getChamferedRectPath(pad.size, pad.radius, 0, 0);
    } else if (pad.shape == "chamfrect") {
      pad.path2d = getChamferedRectPath(pad.size, pad.radius, pad.chamfpos, pad.chamfratio)
    } else if (pad.shape == "custom") {
      pad.path2d = getPolygonsPath(pad);
    }
  }
  return pad.path2d;
}

function drawPad(ctx, pad, color, outline) {
  ctx.save();
  ctx.translate(...pad.pos);
  ctx.rotate(-deg2rad(pad.angle));
  if (pad.offset) {
    ctx.translate(...pad.offset);
  }
  ctx.fillStyle = color;
  ctx.strokeStyle = color;
  var path = getCachedPadPath(pad);
  if (outline) {
    ctx.stroke(path);
  } else {
    ctx.fill(path);
  }
  ctx.restore();
}

function drawPadHole(ctx, pad, padHoleColor) {
  if (pad.type != "th") return;
  ctx.save();
  ctx.translate(...pad.pos);
  ctx.rotate(-deg2rad(pad.angle));
  ctx.fillStyle = padHoleColor;
  if (pad.drillshape == "oblong") {
    ctx.fill(getOblongPath(pad.drillsize));
  } else {
    ctx.fill(getCirclePath(pad.drillsize[0] / 2));
  }
  ctx.restore();
}

function drawFootprint(ctx, layer, scalefactor, footprint, colors, highlight, outline) {
  if (highlight) {
    // draw bounding box
    if (footprint.layer == layer) {
      ctx.save();
      ctx.globalAlpha = 0.2;
      ctx.translate(...footprint.bbox.pos);
      ctx.rotate(deg2rad(-footprint.bbox.angle));
      ctx.translate(...footprint.bbox.relpos);
      ctx.fillStyle = colors.pad;
      ctx.fillRect(0, 0, ...footprint.bbox.size);
      ctx.globalAlpha = 1;
      ctx.strokeStyle = colors.pad;
      ctx.lineWidth = 3 / scalefactor;
      ctx.strokeRect(0, 0, ...footprint.bbox.size);
      ctx.restore();
    }
  }
  // draw drawings
  for (var drawing of footprint.drawings) {
    if (drawing.layer == layer) {
      drawDrawing(ctx, scalefactor, drawing.drawing, colors.pad);
    }
  }
  ctx.lineWidth = 3 / scalefactor;
  // draw pads
  if (settings.renderPads) {
    for (var pad of footprint.pads) {
      if (pad.layers.includes(layer)) {
        drawPad(ctx, pad, colors.pad, outline);
        if (pad.pin1 &&
          (settings.highlightpin1 == "all" ||
            settings.highlightpin1 == "selected" && highlight)) {
          drawPad(ctx, pad, colors.outline, true);
        }
      }
    }
    for (var pad of footprint.pads) {
      drawPadHole(ctx, pad, colors.padHole);
    }
  }
}

function drawEdgeCuts(canvas, scalefactor) {
  var ctx = canvas.getContext("2d");
  var edgecolor = getComputedStyle(topmostdiv).getPropertyValue('--pcb-edge-color');
  for (var edge of pcbdata.edges) {
    drawDrawing(ctx, scalefactor, edge, edgecolor);
  }
}

function drawFootprints(canvas, layer, scalefactor, highlight) {
  var ctx = canvas.getContext("2d");
  ctx.lineWidth = 3 / scalefactor;
  var style = getComputedStyle(topmostdiv);

  var colors = {
    pad: style.getPropertyValue('--pad-color'),
    padHole: style.getPropertyValue('--pad-hole-color'),
    outline: style.getPropertyValue('--pin1-outline-color'),
  }

  for (var i = 0; i < pcbdata.footprints.length; i++) {
    var mod = pcbdata.footprints[i];
    var outline = settings.renderDnpOutline && pcbdata.bom.skipped.includes(i);
    var h = highlightedFootprints.includes(i);
    var d = markedFootprints.has(i);
    if (highlight) {
      if(h && d) {
        colors.pad = style.getPropertyValue('--pad-color-highlight-both');
        colors.outline = style.getPropertyValue('--pin1-outline-color-highlight-both');
      } else if (h) {
        colors.pad = style.getPropertyValue('--pad-color-highlight');
        colors.outline = style.getPropertyValue('--pin1-outline-color-highlight');
      } else if (d) {
        colors.pad = style.getPropertyValue('--pad-color-highlight-marked');
        colors.outline = style.getPropertyValue('--pin1-outline-color-highlight-marked');
      }
    }
    if( h || d || !highlight) {
      drawFootprint(ctx, layer, scalefactor, mod, colors, highlight, outline);
    }
  }
}

function drawBgLayer(layername, canvas, layer, scalefactor, edgeColor, polygonColor, textColor) {
  var ctx = canvas.getContext("2d");
  for (var d of pcbdata.drawings[layername][layer]) {
    if (["segment", "arc", "circle", "curve", "rect"].includes(d.type)) {
      drawedge(ctx, scalefactor, d, edgeColor);
    } else if (d.type == "polygon") {
      drawPolygonShape(ctx, scalefactor, d, polygonColor);
    } else {
      drawText(ctx, d, textColor);
    }
  }
}

function drawTracks(canvas, layer, defaultColor, highlight) {
  ctx = canvas.getContext("2d");
  ctx.lineCap = "round";

  var hasHole = (track) => (
    'drillsize' in track &&
    track.start[0] == track.end[0] &&
    track.start[1] == track.end[1]);

  // First draw tracks and tented vias
  for (var track of pcbdata.tracks[layer]) {
    if (highlight && highlightedNet != track.net) continue;
    if (!hasHole(track)) {
      ctx.strokeStyle = highlight ? defaultColor : settings.netColors[track.net] || defaultColor;
      ctx.lineWidth = track.width;
      ctx.beginPath();
      if ('radius' in track) {
        ctx.arc(
          ...track.center,
          track.radius,
          deg2rad(track.startangle),
          deg2rad(track.endangle));
      } else {
        ctx.moveTo(...track.start);
        ctx.lineTo(...track.end);
      }
      ctx.stroke();
    }
  }
  // Second pass to draw untented vias
  var style = getComputedStyle(topmostdiv);
  var holeColor = style.getPropertyValue('--pad-hole-color')

  for (var track of pcbdata.tracks[layer]) {
    if (highlight && highlightedNet != track.net) continue;
    if (hasHole(track)) {
      ctx.strokeStyle = highlight ? defaultColor : settings.netColors[track.net] || defaultColor;
      ctx.lineWidth = track.width;
      ctx.beginPath();
      ctx.moveTo(...track.start);
      ctx.lineTo(...track.end);
      ctx.stroke();
      ctx.strokeStyle = holeColor;
      ctx.lineWidth = track.drillsize;
      ctx.lineTo(...track.end);
      ctx.stroke();
    }
  }
}

function drawZones(canvas, layer, defaultColor, highlight) {
  ctx = canvas.getContext("2d");
  ctx.lineJoin = "round";
  for (var zone of pcbdata.zones[layer]) {
    if (highlight && highlightedNet != zone.net) continue;
    ctx.strokeStyle = highlight ? defaultColor : settings.netColors[zone.net] || defaultColor;
    ctx.fillStyle = highlight ? defaultColor : settings.netColors[zone.net] || defaultColor;
    if (!zone.path2d) {
      zone.path2d = getPolygonsPath(zone);
    }
    ctx.fill(zone.path2d, zone.fillrule || "nonzero");
    if (zone.width > 0) {
      ctx.lineWidth = zone.width;
      ctx.stroke(zone.path2d);
    }
  }
}

function clearCanvas(canvas, color = null) {
  var ctx = canvas.getContext("2d");
  ctx.save();
  ctx.setTransform(1, 0, 0, 1, 0, 0);
  if (color) {
    ctx.fillStyle = color;
    ctx.fillRect(0, 0, canvas.width, canvas.height);
  } else {
    if (!window.matchMedia("print").matches)
      ctx.clearRect(0, 0, canvas.width, canvas.height);
  }
  ctx.restore();
}

function drawNets(canvas, layer, highlight) {
  var style = getComputedStyle(topmostdiv);
  if (settings.renderZones) {
    var zoneColor = style.getPropertyValue(highlight ? '--zone-color-highlight' : '--zone-color');
    drawZones(canvas, layer, zoneColor, highlight);
  }
  if (settings.renderTracks) {
    var trackColor = style.getPropertyValue(highlight ? '--track-color-highlight' : '--track-color');
    drawTracks(canvas, layer, trackColor, highlight);
  }
  if (highlight && settings.renderPads) {
    var padColor = style.getPropertyValue('--pad-color-highlight');
    var padHoleColor = style.getPropertyValue('--pad-hole-color');
    var ctx = canvas.getContext("2d");
    for (var footprint of pcbdata.footprints) {
      // draw pads
      var padDrawn = false;
      for (var pad of footprint.pads) {
        if (highlightedNet != pad.net) continue;
        if (pad.layers.includes(layer)) {
          drawPad(ctx, pad, padColor, false);
          padDrawn = true;
        }
      }
      if (padDrawn) {
        // redraw all pad holes because some pads may overlap
        for (var pad of footprint.pads) {
          drawPadHole(ctx, pad, padHoleColor);
        }
      }
    }
  }
}

function drawHighlightsOnLayer(canvasdict, clear = true) {
  if (clear) {
    clearCanvas(canvasdict.highlight);
  }
  if (markedFootprints.size > 0 || highlightedFootprints.length > 0) {
    drawFootprints(canvasdict.highlight, canvasdict.layer,
      canvasdict.transform.s * canvasdict.transform.zoom, true);
  }
  if (highlightedNet !== null) {
    drawNets(canvasdict.highlight, canvasdict.layer, true);
  }
}

function drawHighlights() {
  drawHighlightsOnLayer(allcanvas.front);
  drawHighlightsOnLayer(allcanvas.back);
}

function drawBackground(canvasdict, clear = true) {
  if (clear) {
    clearCanvas(canvasdict.bg);
    clearCanvas(canvasdict.fab);
    clearCanvas(canvasdict.silk);
  }

  drawNets(canvasdict.bg, canvasdict.layer, false);
  drawFootprints(canvasdict.bg, canvasdict.layer,
    canvasdict.transform.s * canvasdict.transform.zoom, false);

  drawEdgeCuts(canvasdict.bg, canvasdict.transform.s * canvasdict.transform.zoom);

  var style = getComputedStyle(topmostdiv);
  var edgeColor = style.getPropertyValue('--silkscreen-edge-color');
  var polygonColor = style.getPropertyValue('--silkscreen-polygon-color');
  var textColor = style.getPropertyValue('--silkscreen-text-color');
  if (settings.renderSilkscreen) {
    drawBgLayer(
      "silkscreen", canvasdict.silk, canvasdict.layer,
      canvasdict.transform.s * canvasdict.transform.zoom,
      edgeColor, polygonColor, textColor);
  }
  edgeColor = style.getPropertyValue('--fabrication-edge-color');
  polygonColor = style.getPropertyValue('--fabrication-polygon-color');
  textColor = style.getPropertyValue('--fabrication-text-color');
  if (settings.renderFabrication) {
    drawBgLayer(
      "fabrication", canvasdict.fab, canvasdict.layer,
      canvasdict.transform.s * canvasdict.transform.zoom,
      edgeColor, polygonColor, textColor);
  }
}

function prepareCanvas(canvas, flip, transform) {
  var ctx = canvas.getContext("2d");
  ctx.setTransform(1, 0, 0, 1, 0, 0);
  ctx.scale(transform.zoom, transform.zoom);
  ctx.translate(transform.panx, transform.pany);
  if (flip) {
    ctx.scale(-1, 1);
  }
  ctx.translate(transform.x, transform.y);
  ctx.rotate(deg2rad(settings.boardRotation + (flip && settings.offsetBackRotation ? - 180 : 0)));
  ctx.scale(transform.s, transform.s);
}

function prepareLayer(canvasdict) {
  var flip = (canvasdict.layer === "B");
  for (var c of ["bg", "fab", "silk", "highlight"]) {
    prepareCanvas(canvasdict[c], flip, canvasdict.transform);
  }
}

function rotateVector(v, angle) {
  angle = deg2rad(angle);
  return [
    v[0] * Math.cos(angle) - v[1] * Math.sin(angle),
    v[0] * Math.sin(angle) + v[1] * Math.cos(angle)
  ];
}

function applyRotation(bbox, flip) {
  var corners = [
    [bbox.minx, bbox.miny],
    [bbox.minx, bbox.maxy],
    [bbox.maxx, bbox.miny],
    [bbox.maxx, bbox.maxy],
  ];
  corners = corners.map((v) => rotateVector(v, settings.boardRotation + (flip && settings.offsetBackRotation ? - 180 : 0)));
  return {
    minx: corners.reduce((a, v) => Math.min(a, v[0]), Infinity),
    miny: corners.reduce((a, v) => Math.min(a, v[1]), Infinity),
    maxx: corners.reduce((a, v) => Math.max(a, v[0]), -Infinity),
    maxy: corners.reduce((a, v) => Math.max(a, v[1]), -Infinity),
  }
}

function recalcLayerScale(layerdict, width, height) {
  var flip = (layerdict.layer === "B");
  var bbox = applyRotation(pcbdata.edges_bbox, flip);
  var scalefactor = 0.98 * Math.min(
    width / (bbox.maxx - bbox.minx),
    height / (bbox.maxy - bbox.miny)
  );
  if (scalefactor < 0.1) {
    scalefactor = 1;
  }
  layerdict.transform.s = scalefactor;
  if (flip) {
    layerdict.transform.x = -((bbox.maxx + bbox.minx) * scalefactor + width) * 0.5;
  } else {
    layerdict.transform.x = -((bbox.maxx + bbox.minx) * scalefactor - width) * 0.5;
  }
  layerdict.transform.y = -((bbox.maxy + bbox.miny) * scalefactor - height) * 0.5;
  for (var c of ["bg", "fab", "silk", "highlight"]) {
    canvas = layerdict[c];
    canvas.width = width;
    canvas.height = height;
    canvas.style.width = (width / devicePixelRatio) + "px";
    canvas.style.height = (height / devicePixelRatio) + "px";
  }
}

function redrawCanvas(layerdict) {
  prepareLayer(layerdict);
  drawBackground(layerdict);
  drawHighlightsOnLayer(layerdict);
}

function resizeCanvas(layerdict) {
  var canvasdivid = {
    "F": "frontcanvas",
    "B": "backcanvas"
  } [layerdict.layer];
  var width = document.getElementById(canvasdivid).clientWidth * devicePixelRatio;
  var height = document.getElementById(canvasdivid).clientHeight * devicePixelRatio;
  recalcLayerScale(layerdict, width, height);
  redrawCanvas(layerdict);
}

function resizeAll() {
  resizeCanvas(allcanvas.front);
  resizeCanvas(allcanvas.back);
}

function pointWithinDistanceToSegment(x, y, x1, y1, x2, y2, d) {
  var A = x - x1;
  var B = y - y1;
  var C = x2 - x1;
  var D = y2 - y1;

  var dot = A * C + B * D;
  var len_sq = C * C + D * D;
  var dx, dy;
  if (len_sq == 0) {
    // start and end of the segment coincide
    dx = x - x1;
    dy = y - y1;
  } else {
    var param = dot / len_sq;
    var xx, yy;
    if (param < 0) {
      xx = x1;
      yy = y1;
    } else if (param > 1) {
      xx = x2;
      yy = y2;
    } else {
      xx = x1 + param * C;
      yy = y1 + param * D;
    }
    dx = x - xx;
    dy = y - yy;
  }
  return dx * dx + dy * dy <= d * d;
}

function modulo(n, mod) {
  return ((n % mod) + mod) % mod;
}

function pointWithinDistanceToArc(x, y, xc, yc, radius, startangle, endangle, d) {
  var dx = x - xc;
  var dy = y - yc;
  var r_sq = dx * dx + dy * dy;
  var rmin = Math.max(0, radius - d);
  var rmax = radius + d;

  if (r_sq < rmin * rmin || r_sq > rmax * rmax)
    return false;

  var angle1 = modulo(deg2rad(startangle), 2 * Math.PI);
  var dx1 = xc + radius * Math.cos(angle1) - x;
  var dy1 = yc + radius * Math.sin(angle1) - y;
  if (dx1 * dx1 + dy1 * dy1 <= d * d)
    return true;

  var angle2 = modulo(deg2rad(endangle), 2 * Math.PI);
  var dx2 = xc + radius * Math.cos(angle2) - x;
  var dy2 = yc + radius * Math.sin(angle2) - y;
  if (dx2 * dx2 + dy2 * dy2 <= d * d)
    return true;

  var angle = modulo(Math.atan2(dy, dx), 2 * Math.PI);
  if (angle1 > angle2)
    return (angle >= angle2 || angle <= angle1);
  else
    return (angle >= angle1 && angle <= angle2);
}

function pointWithinPad(x, y, pad) {
  var v = [x - pad.pos[0], y - pad.pos[1]];
  v = rotateVector(v, pad.angle);
  if (pad.offset) {
    v[0] -= pad.offset[0];
    v[1] -= pad.offset[1];
  }
  return emptyContext2d.isPointInPath(getCachedPadPath(pad), ...v);
}

function netHitScan(layer, x, y) {
  // Check track segments
  if (settings.renderTracks && pcbdata.tracks) {
    for (var track of pcbdata.tracks[layer]) {
      if ('radius' in track) {
        if (pointWithinDistanceToArc(x, y, ...track.center, track.radius, track.startangle, track.endangle, track.width / 2)) {
          return track.net;
        }
      } else {
        if (pointWithinDistanceToSegment(x, y, ...track.start, ...track.end, track.width / 2)) {
          return track.net;
        }
      }
    }
  }
  // Check pads
  if (settings.renderPads) {
    for (var footprint of pcbdata.footprints) {
      for (var pad of footprint.pads) {
        if (pad.layers.includes(layer) && pointWithinPad(x, y, pad)) {
          return pad.net;
        }
      }
    }
  }
  return null;
}

function pointWithinFootprintBbox(x, y, bbox) {
  var v = [x - bbox.pos[0], y - bbox.pos[1]];
  v = rotateVector(v, bbox.angle);
  return bbox.relpos[0] <= v[0] && v[0] <= bbox.relpos[0] + bbox.size[0] &&
    bbox.relpos[1] <= v[1] && v[1] <= bbox.relpos[1] + bbox.size[1];
}

function bboxHitScan(layer, x, y) {
  var result = [];
  for (var i = 0; i < pcbdata.footprints.length; i++) {
    var footprint = pcbdata.footprints[i];
    if (footprint.layer == layer) {
      if (pointWithinFootprintBbox(x, y, footprint.bbox)) {
        result.push(i);
      }
    }
  }
  return result;
}

function handlePointerDown(e, layerdict) {
  if (e.button != 0 && e.button != 1) {
    return;
  }
  e.preventDefault();
  e.stopPropagation();

  if (!e.hasOwnProperty("offsetX")) {
    // The polyfill doesn't set this properly
    e.offsetX = e.pageX - e.currentTarget.offsetLeft;
    e.offsetY = e.pageY - e.currentTarget.offsetTop;
  }

  layerdict.pointerStates[e.pointerId] = {
    distanceTravelled: 0,
    lastX: e.offsetX,
    lastY: e.offsetY,
    downTime: Date.now(),
  };
}

function handleMouseClick(e, layerdict) {
  if (!e.hasOwnProperty("offsetX")) {
    // The polyfill doesn't set this properly
    e.offsetX = e.pageX - e.currentTarget.offsetLeft;
    e.offsetY = e.pageY - e.currentTarget.offsetTop;
  }

  var x = e.offsetX;
  var y = e.offsetY;
  var t = layerdict.transform;
  var flip = layerdict.layer === "B";
  if (flip) {
    x = (devicePixelRatio * x / t.zoom - t.panx + t.x) / -t.s;
  } else {
    x = (devicePixelRatio * x / t.zoom - t.panx - t.x) / t.s;
  }
  y = (devicePixelRatio * y / t.zoom - t.y - t.pany) / t.s;
  var v = rotateVector([x, y], -settings.boardRotation + (flip && settings.offsetBackRotation ? - 180 : 0));
  if ("nets" in pcbdata) {
    var net = netHitScan(layerdict.layer, ...v);
    if (net !== highlightedNet) {
      netClicked(net);
    }
  }
  if (highlightedNet === null) {
    var footprints = bboxHitScan(layerdict.layer, ...v);
    if (footprints.length > 0) {
      footprintsClicked(footprints);
    }
  }
}

function handlePointerLeave(e, layerdict) {
  e.preventDefault();
  e.stopPropagation();

  if (!settings.redrawOnDrag) {
    redrawCanvas(layerdict);
  }

  delete layerdict.pointerStates[e.pointerId];
}

function resetTransform(layerdict) {
  layerdict.transform.panx = 0;
  layerdict.transform.pany = 0;
  layerdict.transform.zoom = 1;
  redrawCanvas(layerdict);
}

function handlePointerUp(e, layerdict) {
  if (!e.hasOwnProperty("offsetX")) {
    // The polyfill doesn't set this properly
    e.offsetX = e.pageX - e.currentTarget.offsetLeft;
    e.offsetY = e.pageY - e.currentTarget.offsetTop;
  }

  e.preventDefault();
  e.stopPropagation();

  if (e.button == 2) {
    // Reset pan and zoom on right click.
    resetTransform(layerdict);
    layerdict.anotherPointerTapped = false;
    return;
  }

  // We haven't necessarily had a pointermove event since the interaction started, so make sure we update this now
  var ptr = layerdict.pointerStates[e.pointerId];
  ptr.distanceTravelled += Math.abs(e.offsetX - ptr.lastX) + Math.abs(e.offsetY - ptr.lastY);

  if (e.button == 0 && ptr.distanceTravelled < 10 && Date.now() - ptr.downTime <= 500) {
    if (Object.keys(layerdict.pointerStates).length == 1) {
      if (layerdict.anotherPointerTapped) {
        // This is the second pointer coming off of a two-finger tap
        resetTransform(layerdict);
      } else {
        // This is just a regular tap
        handleMouseClick(e, layerdict);
      }
      layerdict.anotherPointerTapped = false;
    } else {
      // This is the first finger coming off of what could become a two-finger tap
      layerdict.anotherPointerTapped = true;
    }
  } else {
    if (!settings.redrawOnDrag) {
      redrawCanvas(layerdict);
    }
    layerdict.anotherPointerTapped = false;
  }

  delete layerdict.pointerStates[e.pointerId];
}

function handlePointerMove(e, layerdict) {
  if (!layerdict.pointerStates.hasOwnProperty(e.pointerId)) {
    return;
  }
  e.preventDefault();
  e.stopPropagation();

  if (!e.hasOwnProperty("offsetX")) {
    // The polyfill doesn't set this properly
    e.offsetX = e.pageX - e.currentTarget.offsetLeft;
    e.offsetY = e.pageY - e.currentTarget.offsetTop;
  }

  var thisPtr = layerdict.pointerStates[e.pointerId];

  var dx = e.offsetX - thisPtr.lastX;
  var dy = e.offsetY - thisPtr.lastY;

  // If this number is low on pointer up, we count the action as a click
  thisPtr.distanceTravelled += Math.abs(dx) + Math.abs(dy);

  if (Object.keys(layerdict.pointerStates).length == 1) {
    // This is a simple drag
    layerdict.transform.panx += devicePixelRatio * dx / layerdict.transform.zoom;
    layerdict.transform.pany += devicePixelRatio * dy / layerdict.transform.zoom;
  } else if (Object.keys(layerdict.pointerStates).length == 2) {
    var otherPtr = Object.values(layerdict.pointerStates).filter((ptr) => ptr != thisPtr)[0];

    var oldDist = Math.sqrt(Math.pow(thisPtr.lastX - otherPtr.lastX, 2) + Math.pow(thisPtr.lastY - otherPtr.lastY, 2));
    var newDist = Math.sqrt(Math.pow(e.offsetX - otherPtr.lastX, 2) + Math.pow(e.offsetY - otherPtr.lastY, 2));

    var scaleFactor = newDist / oldDist;

    if (scaleFactor != NaN) {
      layerdict.transform.zoom *= scaleFactor;

      var zoomd = (1 - scaleFactor) / layerdict.transform.zoom;
      layerdict.transform.panx += devicePixelRatio * otherPtr.lastX * zoomd;
      layerdict.transform.pany += devicePixelRatio * otherPtr.lastY * zoomd;
    }
  }

  thisPtr.lastX = e.offsetX;
  thisPtr.lastY = e.offsetY;

  if (settings.redrawOnDrag) {
    redrawCanvas(layerdict);
  }
}

function handleMouseWheel(e, layerdict) {
  e.preventDefault();
  e.stopPropagation();
  var t = layerdict.transform;
  var wheeldelta = e.deltaY;
  if (e.deltaMode == 1) {
    // FF only, scroll by lines
    wheeldelta *= 30;
  } else if (e.deltaMode == 2) {
    wheeldelta *= 300;
  }
  var m = Math.pow(1.1, -wheeldelta / 40);
  // Limit amount of zoom per tick.
  if (m > 2) {
    m = 2;
  } else if (m < 0.5) {
    m = 0.5;
  }
  t.zoom *= m;
  var zoomd = (1 - m) / t.zoom;
  t.panx += devicePixelRatio * e.offsetX * zoomd;
  t.pany += devicePixelRatio * e.offsetY * zoomd;
  redrawCanvas(layerdict);
}

function addMouseHandlers(div, layerdict) {
  div.addEventListener("pointerdown", function(e) {
    handlePointerDown(e, layerdict);
  });
  div.addEventListener("pointermove", function(e) {
    handlePointerMove(e, layerdict);
  });
  div.addEventListener("pointerup", function(e) {
    handlePointerUp(e, layerdict);
  });
  var pointerleave = function(e) {
    handlePointerLeave(e, layerdict);
  }
  div.addEventListener("pointercancel", pointerleave);
  div.addEventListener("pointerleave", pointerleave);
  div.addEventListener("pointerout", pointerleave);

  div.onwheel = function(e) {
    handleMouseWheel(e, layerdict);
  }
  for (var element of [div, layerdict.bg, layerdict.fab, layerdict.silk, layerdict.highlight]) {
    element.addEventListener("contextmenu", function(e) {
      e.preventDefault();
    }, false);
  }
}

function setRedrawOnDrag(value) {
  settings.redrawOnDrag = value;
  writeStorage("redrawOnDrag", value);
}

function setBoardRotation(value) {
  settings.boardRotation = value * 5;
  writeStorage("boardRotation", settings.boardRotation);
  document.getElementById("rotationDegree").textContent = settings.boardRotation;
  resizeAll();
}

function setOffsetBackRotation(value) {
  settings.offsetBackRotation = value;
  writeStorage("offsetBackRotation", value);
  resizeAll();
}

function initRender() {
  allcanvas = {
    front: {
      transform: {
        x: 0,
        y: 0,
        s: 1,
        panx: 0,
        pany: 0,
        zoom: 1,
      },
      pointerStates: {},
      anotherPointerTapped: false,
      bg: document.getElementById("F_bg"),
      fab: document.getElementById("F_fab"),
      silk: document.getElementById("F_slk"),
      highlight: document.getElementById("F_hl"),
      layer: "F",
    },
    back: {
      transform: {
        x: 0,
        y: 0,
        s: 1,
        panx: 0,
        pany: 0,
        zoom: 1,
      },
      pointerStates: {},
      anotherPointerTapped: false,
      bg: document.getElementById("B_bg"),
      fab: document.getElementById("B_fab"),
      silk: document.getElementById("B_slk"),
      highlight: document.getElementById("B_hl"),
      layer: "B",
    }
  };
  addMouseHandlers(document.getElementById("frontcanvas"), allcanvas.front);
  addMouseHandlers(document.getElementById("backcanvas"), allcanvas.back);
}

///////////////////////////////////////////////

///////////////////////////////////////////////
/*
 * Table reordering via Drag'n'Drop
 * Inspired by: https://htmldom.dev/drag-and-drop-table-column
 */

function setBomHandlers() {

  const bom = document.getElementById('bomtable');

  let dragName;
  let placeHolderElements;
  let draggingElement;
  let forcePopulation;
  let xOffset;
  let yOffset;
  let wasDragged;

  const mouseUpHandler = function(e) {
    // Delete dragging element
    draggingElement.remove();

    // Make BOM selectable again
    bom.style.removeProperty("userSelect");

    // Remove listeners
    document.removeEventListener('mousemove', mouseMoveHandler);
    document.removeEventListener('mouseup', mouseUpHandler);

    if (wasDragged) {
      // Redraw whole BOM
      populateBomTable();
    }
  }

  const mouseMoveHandler = function(e) {
    // Notice the dragging
    wasDragged = true;

    // Make the dragged element visible
    draggingElement.style.removeProperty("display");

    // Set elements position to mouse position
    draggingElement.style.left = `${e.screenX - xOffset}px`;
    draggingElement.style.top = `${e.screenY - yOffset}px`;

    // Forced redrawing of BOM table
    if (forcePopulation) {
      forcePopulation = false;
      // Copy array
      phe = Array.from(placeHolderElements);
      // populate BOM table again
      populateBomHeader(dragName, phe);
      populateBomBody(dragName, phe);
    }

    // Set up array of hidden columns
    var hiddenColumns = Array.from(settings.hiddenColumns);
    // In the ungrouped mode, quantity don't exist
    if (settings.bommode === "ungrouped")
      hiddenColumns.push("Quantity");
    // If no checkbox fields can be found, we consider them hidden
    if (settings.checkboxes.length == 0)
      hiddenColumns.push("checkboxes");

    // Get table headers and group them into checkboxes, extrafields and normal headers
    const bh = document.getElementById("bomhead");
    headers = Array.from(bh.querySelectorAll("th"))
    headers.shift() // numCol is not part of the columnOrder
    headerGroups = []
    lastCompoundClass = null;
    for (i = 0; i < settings.columnOrder.length; i++) {
      cElem = settings.columnOrder[i];
      if (hiddenColumns.includes(cElem)) {
        // Hidden columns appear as a dummy element
        headerGroups.push([]);
        continue;
      }
      elem = headers.filter(e => getColumnOrderName(e) === cElem)[0];
      if (elem.classList.contains("bom-checkbox")) {
        if (lastCompoundClass === "bom-checkbox") {
          cbGroup = headerGroups.pop();
          cbGroup.push(elem);
          headerGroups.push(cbGroup);
        } else {
          lastCompoundClass = "bom-checkbox";
          headerGroups.push([elem])
        }
      } else {
        headerGroups.push([elem])
      }
    }

    // Copy settings.columnOrder
    var columns = Array.from(settings.columnOrder)

    // Set up array with indices of hidden columns
    var hiddenIndices = hiddenColumns.map(e => settings.columnOrder.indexOf(e));
    var dragIndex = columns.indexOf(dragName);
    var swapIndex = dragIndex;
    var swapDone = false;

    // Check if the current dragged element is swapable with the left or right element
    if (dragIndex > 0) {
      // Get left headers boundingbox
      swapIndex = dragIndex - 1;
      while (hiddenIndices.includes(swapIndex) && swapIndex > 0)
        swapIndex--;
      if (!hiddenIndices.includes(swapIndex)) {
        box = getBoundingClientRectFromMultiple(headerGroups[swapIndex]);
        if (e.clientX < box.left + window.scrollX + (box.width / 2)) {
          swapElement = columns[dragIndex];
          columns.splice(dragIndex, 1);
          columns.splice(swapIndex, 0, swapElement);
          forcePopulation = true;
          swapDone = true;
        }
      }
    }
    if ((!swapDone) && dragIndex < headerGroups.length - 1) {
      // Get right headers boundingbox
      swapIndex = dragIndex + 1;
      while (hiddenIndices.includes(swapIndex))
        swapIndex++;
      if (swapIndex < headerGroups.length) {
        box = getBoundingClientRectFromMultiple(headerGroups[swapIndex]);
        if (e.clientX > box.left + window.scrollX + (box.width / 2)) {
          swapElement = columns[dragIndex];
          columns.splice(dragIndex, 1);
          columns.splice(swapIndex, 0, swapElement);
          forcePopulation = true;
          swapDone = true;
        }
      }
    }

    // Write back change to storage
    if (swapDone) {
      settings.columnOrder = columns
      writeStorage("columnOrder", JSON.stringify(columns));
    }

  }

  const mouseDownHandler = function(e) {
    var target = e.target;
    if (target.tagName.toLowerCase() != "td")
      target = target.parentElement;

    // Used to check if a dragging has ever happened
    wasDragged = false;

    // Create new element which will be displayed as the dragged column
    draggingElement = document.createElement("div")
    draggingElement.classList.add("dragging");
    draggingElement.style.display = "none";
    draggingElement.style.position = "absolute";
    draggingElement.style.overflow = "hidden";

    // Get bomhead and bombody elements
    const bh = document.getElementById("bomhead");
    const bb = document.getElementById("bombody");

    // Get all compound headers for the current column
    var compoundHeaders;
    if (target.classList.contains("bom-checkbox")) {
      compoundHeaders = Array.from(bh.querySelectorAll("th.bom-checkbox"));
    } else {
      compoundHeaders = [target];
    }

    // Create new table which will display the column
    var newTable = document.createElement("table");
    newTable.classList.add("bom");
    newTable.style.background = "white";
    draggingElement.append(newTable);

    // Create new header element
    var newHeader = document.createElement("thead");
    newTable.append(newHeader);

    // Set up array for storing all placeholder elements
    placeHolderElements = [];

    // Add all compound headers to the new thead element and placeholders
    compoundHeaders.forEach(function(h) {
      clone = cloneElementWithDimensions(h);
      newHeader.append(clone);
      placeHolderElements.push(clone);
    });

    // Create new body element
    var newBody = document.createElement("tbody");
    newTable.append(newBody);

    // Get indices for compound headers
    var idxs = compoundHeaders.map(e => getBomTableHeaderIndex(e));

    // For each row in the BOM body...
    var rows = bb.querySelectorAll("tr");
    rows.forEach(function(row) {
      // ..get the cells for the compound column
      const tds = row.querySelectorAll("td");
      var copytds = idxs.map(i => tds[i]);
      // Add them to the new element and the placeholders
      var newRow = document.createElement("tr");
      copytds.forEach(function(td) {
        clone = cloneElementWithDimensions(td);
        newRow.append(clone);
        placeHolderElements.push(clone);
      });
      newBody.append(newRow);
    });

    // Compute width for compound header
    var width = compoundHeaders.reduce((acc, x) => acc + x.clientWidth, 0);
    draggingElement.style.width = `${width}px`;

    // Insert the new dragging element and disable selection on BOM
    bom.insertBefore(draggingElement, null);
    bom.style.userSelect = "none";

    // Determine the mouse position offset
    xOffset = e.screenX - compoundHeaders.reduce((acc, x) => Math.min(acc, x.offsetLeft), compoundHeaders[0].offsetLeft);
    yOffset = e.screenY - compoundHeaders[0].offsetTop;

    // Get name for the column in settings.columnOrder
    dragName = getColumnOrderName(target);

    // Change text and class for placeholder elements
    placeHolderElements = placeHolderElements.map(function(e) {
      newElem = cloneElementWithDimensions(e);
      newElem.textContent = "";
      newElem.classList.add("placeholder");
      return newElem;
    });

    // On next mouse move, the whole BOM needs to be redrawn to show the placeholders
    forcePopulation = true;

    // Add listeners for move and up on mouse
    document.addEventListener('mousemove', mouseMoveHandler);
    document.addEventListener('mouseup', mouseUpHandler);
  }

  // In netlist mode, there is nothing to reorder
  if (settings.bommode === "netlist")
    return;

  // Add mouseDownHandler to every column except the numCol
  bom.querySelectorAll("th")
    .forEach(function(head) {
      if (!head.classList.contains("numCol")) {
        head.onmousedown = mouseDownHandler;
      }
    });

}

function getBoundingClientRectFromMultiple(elements) {
  var elems = Array.from(elements);

  if (elems.length == 0)
    return null;

  var box = elems.shift()
    .getBoundingClientRect();

  elems.forEach(function(elem) {
    var elembox = elem.getBoundingClientRect();
    box.left = Math.min(elembox.left, box.left);
    box.top = Math.min(elembox.top, box.top);
    box.width += elembox.width;
    box.height = Math.max(elembox.height, box.height);
  });

  return box;
}

function cloneElementWithDimensions(elem) {
  var newElem = elem.cloneNode(true);
  newElem.style.height = window.getComputedStyle(elem).height;
  newElem.style.width = window.getComputedStyle(elem).width;
  return newElem;
}

function getBomTableHeaderIndex(elem) {
  const bh = document.getElementById('bomhead');
  const ths = Array.from(bh.querySelectorAll("th"));
  return ths.indexOf(elem);
}

function getColumnOrderName(elem) {
  var cname = elem.getAttribute("col_name");
  if (cname === "bom-checkbox")
    return "checkboxes";
  else
    return cname;
}

function resizableGrid(tablehead) {
  var cols = tablehead.firstElementChild.children;
  var rowWidth = tablehead.offsetWidth;

  for (var i = 1; i < cols.length; i++) {
    if (cols[i].classList.contains("bom-checkbox"))
      continue;
    cols[i].style.width = ((cols[i].clientWidth - paddingDiff(cols[i])) * 100 / rowWidth) + '%';
  }

  for (var i = 1; i < cols.length - 1; i++) {
    var div = document.createElement('div');
    div.className = "column-width-handle";
    cols[i].appendChild(div);
    setListeners(div);
  }

  function setListeners(div) {
    var startX, curCol, nxtCol, curColWidth, nxtColWidth, rowWidth;

    div.addEventListener('mousedown', function(e) {
      e.preventDefault();
      e.stopPropagation();

      curCol = e.target.parentElement;
      nxtCol = curCol.nextElementSibling;
      startX = e.pageX;

      var padding = paddingDiff(curCol);

      rowWidth = curCol.parentElement.offsetWidth;
      curColWidth = curCol.clientWidth - padding;
      nxtColWidth = nxtCol.clientWidth - padding;
    });

    document.addEventListener('mousemove', function(e) {
      if (startX) {
        var diffX = e.pageX - startX;
        diffX = -Math.min(-diffX, curColWidth - 20);
        diffX = Math.min(diffX, nxtColWidth - 20);

        curCol.style.width = ((curColWidth + diffX) * 100 / rowWidth) + '%';
        nxtCol.style.width = ((nxtColWidth - diffX) * 100 / rowWidth) + '%';
        console.log(`${curColWidth + nxtColWidth} ${(curColWidth + diffX) * 100 / rowWidth + (nxtColWidth - diffX) * 100 / rowWidth}`);
      }
    });

    document.addEventListener('mouseup', function(e) {
      curCol = undefined;
      nxtCol = undefined;
      startX = undefined;
      nxtColWidth = undefined;
      curColWidth = undefined
    });
  }

  function paddingDiff(col) {

    if (getStyleVal(col, 'box-sizing') == 'border-box') {
      return 0;
    }

    var padLeft = getStyleVal(col, 'padding-left');
    var padRight = getStyleVal(col, 'padding-right');
    return (parseInt(padLeft) + parseInt(padRight));

  }

  function getStyleVal(elm, css) {
    return (window.getComputedStyle(elm, null).getPropertyValue(css))
  }
}

///////////////////////////////////////////////

///////////////////////////////////////////////
/* DOM manipulation and misc code */

var bomsplit;
var canvassplit;
var initDone = false;
var bomSortFunction = null;
var currentSortColumn = null;
var currentSortOrder = null;
var currentHighlightedRowId;
var highlightHandlers = [];
var footprintIndexToHandler = {};
var netsToHandler = {};
var markedFootprints = new Set();
var highlightedFootprints = [];
var highlightedNet = null;
var lastClicked;

function dbg(html) {
  dbgdiv.innerHTML = html;
}

function redrawIfInitDone() {
  if (initDone) {
    redrawCanvas(allcanvas.front);
    redrawCanvas(allcanvas.back);
  }
}

function padsVisible(value) {
  writeStorage("padsVisible", value);
  settings.renderPads = value;
  redrawIfInitDone();
}

function referencesVisible(value) {
  writeStorage("referencesVisible", value);
  settings.renderReferences = value;
  redrawIfInitDone();
}

function valuesVisible(value) {
  writeStorage("valuesVisible", value);
  settings.renderValues = value;
  redrawIfInitDone();
}

function tracksVisible(value) {
  writeStorage("tracksVisible", value);
  settings.renderTracks = value;
  redrawIfInitDone();
}

function zonesVisible(value) {
  writeStorage("zonesVisible", value);
  settings.renderZones = value;
  redrawIfInitDone();
}

function dnpOutline(value) {
  writeStorage("dnpOutline", value);
  settings.renderDnpOutline = value;
  redrawIfInitDone();
}

function setDarkMode(value) {
  if (value) {
    topmostdiv.classList.add("dark");
  } else {
    topmostdiv.classList.remove("dark");
  }
  writeStorage("darkmode", value);
  settings.darkMode = value;
  redrawIfInitDone();
  if (initDone) {
    populateBomTable();
  }
}

function setShowBOMColumn(field, value) {
  if (field === "references") {
    var rl = document.getElementById("reflookup");
    rl.disabled = !value;
    if (!value) {
      rl.value = "";
      updateRefLookup("");
    }
  }

  var n = settings.hiddenColumns.indexOf(field);
  if (value) {
    if (n != -1) {
      settings.hiddenColumns.splice(n, 1);
    }
  } else {
    if (n == -1) {
      settings.hiddenColumns.push(field);
    }
  }

  writeStorage("hiddenColumns", JSON.stringify(settings.hiddenColumns));

  if (initDone) {
    populateBomTable();
  }

  redrawIfInitDone();
}


function setFullscreen(value) {
  if (value) {
    document.documentElement.requestFullscreen();
  } else {
    document.exitFullscreen();
  }
}

function fabricationVisible(value) {
  writeStorage("fabricationVisible", value);
  settings.renderFabrication = value;
  redrawIfInitDone();
}

function silkscreenVisible(value) {
  writeStorage("silkscreenVisible", value);
  settings.renderSilkscreen = value;
  redrawIfInitDone();
}

function setHighlightPin1(value) {
  writeStorage("highlightpin1", value);
  settings.highlightpin1 = value;
  redrawIfInitDone();
}

function getStoredCheckboxRefs(checkbox) {
  function convert(ref) {
    var intref = parseInt(ref);
    if (isNaN(intref)) {
      for (var i = 0; i < pcbdata.footprints.length; i++) {
        if (pcbdata.footprints[i].ref == ref) {
          return i;
        }
      }
      return -1;
    } else {
      return intref;
    }
  }
  if (!(checkbox in settings.checkboxStoredRefs)) {
    var val = readStorage("checkbox_" + checkbox);
    settings.checkboxStoredRefs[checkbox] = val ? val : "";
  }
  if (!settings.checkboxStoredRefs[checkbox]) {
    return new Set();
  } else {
    return new Set(settings.checkboxStoredRefs[checkbox].split(",").map(r => convert(r)).filter(a => a >= 0));
  }
}

function getCheckboxState(checkbox, references) {
  var storedRefsSet = getStoredCheckboxRefs(checkbox);
  var currentRefsSet = new Set(references.map(r => r[1]));
  // Get difference of current - stored
  var difference = new Set(currentRefsSet);
  for (ref of storedRefsSet) {
    difference.delete(ref);
  }
  if (difference.size == 0) {
    // All the current refs are stored
    return "checked";
  } else if (difference.size == currentRefsSet.size) {
    // None of the current refs are stored
    return "unchecked";
  } else {
    // Some of the refs are stored
    return "indeterminate";
  }
}

function setBomCheckboxState(checkbox, element, references) {
  var state = getCheckboxState(checkbox, references);
  element.checked = (state == "checked");
  element.indeterminate = (state == "indeterminate");
}

function createCheckboxChangeHandler(checkbox, references, row) {
  return function () {
    refsSet = getStoredCheckboxRefs(checkbox);
    var markWhenChecked = settings.markWhenChecked == checkbox;
    eventArgs = {
      checkbox: checkbox,
      refs: references,
    }
    if (this.checked) {
      // checkbox ticked
      for (var ref of references) {
        refsSet.add(ref[1]);
      }
      if (markWhenChecked) {
        row.classList.add("checked");
        for (var ref of references) {
          markedFootprints.add(ref[1]);
        }
        drawHighlights();
      }
      eventArgs.state = 'checked';
    } else {
      // checkbox unticked
      for (var ref of references) {
        refsSet.delete(ref[1]);
      }
      if (markWhenChecked) {
        row.classList.remove("checked");
        for (var ref of references) {
          markedFootprints.delete(ref[1]);
        }
        drawHighlights();
      }
      eventArgs.state = 'unchecked';
    }
    settings.checkboxStoredRefs[checkbox] = [...refsSet].join(",");
    writeStorage("checkbox_" + checkbox, settings.checkboxStoredRefs[checkbox]);
    updateCheckboxStats(checkbox);
    EventHandler.emitEvent(IBOM_EVENT_TYPES.CHECKBOX_CHANGE_EVENT, eventArgs);
  }
}

function clearHighlightedFootprints() {
  if (currentHighlightedRowId) {
    document.getElementById(currentHighlightedRowId).classList.remove("highlighted");
    currentHighlightedRowId = null;
    highlightedFootprints = [];
    highlightedNet = null;
  }
}

function createRowHighlightHandler(rowid, refs, net) {
  return function () {
    if (currentHighlightedRowId) {
      if (currentHighlightedRowId == rowid) {
        return;
      }
      document.getElementById(currentHighlightedRowId).classList.remove("highlighted");
    }
    document.getElementById(rowid).classList.add("highlighted");
    currentHighlightedRowId = rowid;
    highlightedFootprints = refs ? refs.map(r => r[1]) : [];
    highlightedNet = net;
    drawHighlights();
    EventHandler.emitEvent(
      IBOM_EVENT_TYPES.HIGHLIGHT_EVENT, {
      rowid: rowid,
      refs: refs,
      net: net
    });
  }
}

function updateNetColors() {
  writeStorage("netColors", JSON.stringify(settings.netColors));
  redrawIfInitDone();
}

function netColorChangeHandler(net) {
  return (event) => {
    settings.netColors[net] = event.target.value;
    updateNetColors();
  }
}

function netColorRightClick(net) {
  return (event) => {
    if (event.button == 2) {
      event.preventDefault();
      event.stopPropagation();

      var style = getComputedStyle(topmostdiv);
      var defaultNetColor = style.getPropertyValue('--track-color').trim();
      event.target.value = defaultNetColor;
      delete settings.netColors[net];
      updateNetColors();
    }
  }
}

function entryMatches(entry) {
  if (settings.bommode == "netlist") {
    // entry is just a net name
    return entry.toLowerCase().indexOf(filter) >= 0;
  }
  // check refs
  if (!settings.hiddenColumns.includes("references")) {
    for (var ref of entry) {
      if (ref[0].toLowerCase().indexOf(filter) >= 0) {
        return true;
      }
    }
  }
  // check fields
  for (var i in config.fields) {
    var f = config.fields[i];
    if (!settings.hiddenColumns.includes(f)) {
      for (var ref of entry) {
        if (String(pcbdata.bom.fields[ref[1]][i]).toLowerCase().indexOf(filter) >= 0) {
          return true;
        }
      }
    }
  }
  return false;
}

function findRefInEntry(entry) {
  return entry.filter(r => r[0].toLowerCase() == reflookup);
}

function highlightFilter(s) {
  if (!filter) {
    return s;
  }
  var parts = s.toLowerCase().split(filter);
  if (parts.length == 1) {
    return s;
  }
  var r = "";
  var pos = 0;
  for (var i in parts) {
    if (i > 0) {
      r += '<mark class="highlight">' +
        s.substring(pos, pos + filter.length) +
        '</mark>';
      pos += filter.length;
    }
    r += s.substring(pos, pos + parts[i].length);
    pos += parts[i].length;
  }
  return r;
}

function checkboxSetUnsetAllHandler(checkboxname) {
  return function () {
    var checkboxnum = 0;
    while (checkboxnum < settings.checkboxes.length &&
      settings.checkboxes[checkboxnum].toLowerCase() != checkboxname.toLowerCase()) {
      checkboxnum++;
    }
    if (checkboxnum >= settings.checkboxes.length) {
      return;
    }
    var allset = true;
    var checkbox;
    var row;
    for (row of bombody.childNodes) {
      checkbox = row.childNodes[checkboxnum + 1].childNodes[0];
      if (!checkbox.checked || checkbox.indeterminate) {
        allset = false;
        break;
      }
    }
    for (row of bombody.childNodes) {
      checkbox = row.childNodes[checkboxnum + 1].childNodes[0];
      checkbox.checked = !allset;
      checkbox.indeterminate = false;
      checkbox.onchange();
    }
  }
}

function createColumnHeader(name, cls, comparator, is_checkbox = false) {
  var th = document.createElement("TH");
  th.innerHTML = name;
  th.classList.add(cls);
  if (is_checkbox)
    th.setAttribute("col_name", "bom-checkbox");
  else
    th.setAttribute("col_name", name);
  var span = document.createElement("SPAN");
  span.classList.add("sortmark");
  span.classList.add("none");
  th.appendChild(span);
  var spacer = document.createElement("div");
  spacer.className = "column-spacer";
  th.appendChild(spacer);
  spacer.onclick = function () {
    if (currentSortColumn && th !== currentSortColumn) {
      // Currently sorted by another column
      currentSortColumn.childNodes[1].classList.remove(currentSortOrder);
      currentSortColumn.childNodes[1].classList.add("none");
      currentSortColumn = null;
      currentSortOrder = null;
    }
    if (currentSortColumn && th === currentSortColumn) {
      // Already sorted by this column
      if (currentSortOrder == "asc") {
        // Sort by this column, descending order
        bomSortFunction = function (a, b) {
          return -comparator(a, b);
        }
        currentSortColumn.childNodes[1].classList.remove("asc");
        currentSortColumn.childNodes[1].classList.add("desc");
        currentSortOrder = "desc";
      } else {
        // Unsort
        bomSortFunction = null;
        currentSortColumn.childNodes[1].classList.remove("desc");
        currentSortColumn.childNodes[1].classList.add("none");
        currentSortColumn = null;
        currentSortOrder = null;
      }
    } else {
      // Sort by this column, ascending order
      bomSortFunction = comparator;
      currentSortColumn = th;
      currentSortColumn.childNodes[1].classList.remove("none");
      currentSortColumn.childNodes[1].classList.add("asc");
      currentSortOrder = "asc";
    }
    populateBomBody();
  }
  if (is_checkbox) {
    spacer.onclick = fancyDblClickHandler(
      spacer, spacer.onclick, checkboxSetUnsetAllHandler(name));
  }
  return th;
}

function populateBomHeader(placeHolderColumn = null, placeHolderElements = null) {
  while (bomhead.firstChild) {
    bomhead.removeChild(bomhead.firstChild);
  }
  var tr = document.createElement("TR");
  var th = document.createElement("TH");
  th.classList.add("numCol");

  var vismenu = document.createElement("div");
  vismenu.id = "vismenu";
  vismenu.classList.add("menu");

  var visbutton = document.createElement("div");
  visbutton.classList.add("visbtn");
  visbutton.classList.add("hideonprint");

  var viscontent = document.createElement("div");
  viscontent.classList.add("menu-content");
  viscontent.id = "vismenu-content";

  settings.columnOrder.forEach(column => {
    if (typeof column !== "string")
      return;

    // Skip empty columns
    if (column === "checkboxes" && settings.checkboxes.length == 0)
      return;
    else if (column === "Quantity" && settings.bommode == "ungrouped")
      return;

    var label = document.createElement("label");
    label.classList.add("menu-label");

    var input = document.createElement("input");
    input.classList.add("visibility_checkbox");
    input.type = "checkbox";
    input.onchange = function (e) {
      setShowBOMColumn(column, e.target.checked)
    };
    input.checked = !(settings.hiddenColumns.includes(column));

    label.appendChild(input);
    if (column.length > 0)
      label.append(column[0].toUpperCase() + column.slice(1));

    viscontent.appendChild(label);
  });

  viscontent.childNodes[0].classList.add("menu-label-top");

  vismenu.appendChild(visbutton);
  if (settings.bommode != "netlist") {
    vismenu.appendChild(viscontent);
    th.appendChild(vismenu);
  }
  tr.appendChild(th);

  var checkboxCompareClosure = function (checkbox) {
    return (a, b) => {
      var stateA = getCheckboxState(checkbox, a);
      var stateB = getCheckboxState(checkbox, b);
      if (stateA > stateB) return -1;
      if (stateA < stateB) return 1;
      return 0;
    }
  }
  var stringFieldCompareClosure = function (fieldIndex) {
    return (a, b) => {
      var fa = pcbdata.bom.fields[a[0][1]][fieldIndex];
      var fb = pcbdata.bom.fields[b[0][1]][fieldIndex];
      if (fa != fb) return fa > fb ? 1 : -1;
      else return 0;
    }
  }
  var referenceRegex = /(?<prefix>[^0-9]+)(?<number>[0-9]+)/;
  var compareRefs = (a, b) => {
    var ra = referenceRegex.exec(a);
    var rb = referenceRegex.exec(b);
    if (ra === null || rb === null) {
      if (a != b) return a > b ? 1 : -1;
      return 0;
    } else {
      if (ra.groups.prefix != rb.groups.prefix) {
        return ra.groups.prefix > rb.groups.prefix ? 1 : -1;
      }
      if (ra.groups.number != rb.groups.number) {
        return parseInt(ra.groups.number) > parseInt(rb.groups.number) ? 1 : -1;
      }
      return 0;
    }
  }
  if (settings.bommode == "netlist") {
    tr.appendChild(createColumnHeader("Net name", "bom-netname", (a, b) => {
      if (a > b) return -1;
      if (a < b) return 1;
      return 0;
    }));
    tr.appendChild(createColumnHeader("Color", "bom-color", (a, b) => {
      return 0;
    }));
  } else {
    // Filter hidden columns
    var columns = settings.columnOrder.filter(e => !settings.hiddenColumns.includes(e));
    var valueIndex = config.fields.indexOf("Value");
    var footprintIndex = config.fields.indexOf("Footprint");
    columns.forEach((column) => {
      if (column === placeHolderColumn) {
        var n = 1;
        if (column === "checkboxes")
          n = settings.checkboxes.length;
        for (i = 0; i < n; i++) {
          td = placeHolderElements.shift();
          tr.appendChild(td);
        }
        return;
      } else if (column === "checkboxes") {
        for (var checkbox of settings.checkboxes) {
          th = createColumnHeader(
            checkbox, "bom-checkbox", checkboxCompareClosure(checkbox), true);
          tr.appendChild(th);
        }
      } else if (column === "References") {
        tr.appendChild(createColumnHeader("References", "references", (a, b) => {
          var i = 0;
          while (i < a.length && i < b.length) {
            if (a[i] != b[i]) return compareRefs(a[i][0], b[i][0]);
            i++;
          }
          return a.length - b.length;
        }));
      } else if (column === "Value") {
        tr.appendChild(createColumnHeader("Value", "value", (a, b) => {
          var ra = a[0][1], rb = b[0][1];
          return valueCompare(
            pcbdata.bom.parsedValues[ra], pcbdata.bom.parsedValues[rb],
            pcbdata.bom.fields[ra][valueIndex], pcbdata.bom.fields[rb][valueIndex]);
        }));
        return;
      } else if (column === "Footprint") {
        tr.appendChild(createColumnHeader(
          "Footprint", "footprint", stringFieldCompareClosure(footprintIndex)));
      } else if (column === "Quantity" && settings.bommode == "grouped") {
        tr.appendChild(createColumnHeader("Quantity", "quantity", (a, b) => {
          return a.length - b.length;
        }));
      } else {
        // Other fields
        var i = config.fields.indexOf(column);
        if (i < 0)
          return;
        tr.appendChild(createColumnHeader(
          column, `field${i + 1}`, stringFieldCompareClosure(i)));
      }
    });
  }
  bomhead.appendChild(tr);
}

function populateBomBody(placeholderColumn = null, placeHolderElements = null) {
  const urlRegex = /^(https?:\/\/[^\s\/$.?#][^\s]*|file:\/\/([a-zA-Z]:|\/)[^\x00]+)$/;
  while (bom.firstChild) {
    bom.removeChild(bom.firstChild);
  }
  highlightHandlers = [];
  footprintIndexToHandler = {};
  netsToHandler = {};
  currentHighlightedRowId = null;
  var first = true;
  var style = getComputedStyle(topmostdiv);
  var defaultNetColor = style.getPropertyValue('--track-color').trim();
  if (settings.bommode == "netlist") {
    bomtable = pcbdata.nets.slice();
  } else {
    switch (settings.canvaslayout) {
      case 'F':
        bomtable = pcbdata.bom.F.slice();
        break;
      case 'FB':
        bomtable = pcbdata.bom.both.slice();
        break;
      case 'B':
        bomtable = pcbdata.bom.B.slice();
        break;
    }
    if (settings.bommode == "ungrouped") {
      // expand bom table
      expandedTable = []
      for (var bomentry of bomtable) {
        for (var ref of bomentry) {
          expandedTable.push([ref]);
        }
      }
      bomtable = expandedTable;
    }
  }
  if (bomSortFunction) {
    bomtable = bomtable.sort(bomSortFunction);
  }
  for (var i in bomtable) {
    var bomentry = bomtable[i];
    if (filter && !entryMatches(bomentry)) {
      continue;
    }
    var references = null;
    var netname = null;
    var tr = document.createElement("TR");
    var td = document.createElement("TD");
    var rownum = +i + 1;
    tr.id = "bomrow" + rownum;
    td.textContent = rownum;
    tr.appendChild(td);
    if (settings.bommode == "netlist") {
      netname = bomentry;
      td = document.createElement("TD");
      td.innerHTML = highlightFilter(netname ? netname : "&lt;no net&gt;");
      tr.appendChild(td);
      var color = settings.netColors[netname] || defaultNetColor;
      td = document.createElement("TD");
      var colorBox = document.createElement("INPUT");
      colorBox.type = "color";
      colorBox.value = color;
      colorBox.onchange = netColorChangeHandler(netname);
      colorBox.onmouseup = netColorRightClick(netname);
      colorBox.oncontextmenu = (e) => e.preventDefault();
      td.appendChild(colorBox);
      td.classList.add("color-column");
      tr.appendChild(td);
    } else {
      if (reflookup) {
        references = findRefInEntry(bomentry);
        if (references.length == 0) {
          continue;
        }
      } else {
        references = bomentry;
      }
      // Filter hidden columns
      var columns = settings.columnOrder.filter(e => !settings.hiddenColumns.includes(e));
      columns.forEach((column) => {
        if (column === placeholderColumn) {
          var n = 1;
          if (column === "checkboxes")
            n = settings.checkboxes.length;
          for (i = 0; i < n; i++) {
            td = placeHolderElements.shift();
            tr.appendChild(td);
          }
          return;
        } else if (column === "checkboxes") {
          for (var checkbox of settings.checkboxes) {
            if (checkbox) {
              td = document.createElement("TD");
              var input = document.createElement("input");
              input.type = "checkbox";
              input.onchange = createCheckboxChangeHandler(checkbox, references, tr);
              setBomCheckboxState(checkbox, input, references);
              if (input.checked && settings.markWhenChecked == checkbox) {
                tr.classList.add("checked");
              }
              td.appendChild(input);
              tr.appendChild(td);
            }
          }
        } else if (column === "References") {
          td = document.createElement("TD");
          td.innerHTML = highlightFilter(references.map(r => r[0]).join(", "));
          tr.appendChild(td);
        } else if (column === "Quantity" && settings.bommode == "grouped") {
          // Quantity
          td = document.createElement("TD");
          td.textContent = references.length;
          tr.appendChild(td);
        } else {
          // All the other fields
          var field_index = config.fields.indexOf(column)
          if (field_index < 0)
            return;
          var valueSet = new Set();
          references.map(r => r[1]).forEach((id) => valueSet.add(pcbdata.bom.fields[id][field_index]));
          td = document.createElement("TD");
          var output = new Array();
          for (let item of valueSet) {
            const visible = highlightFilter(String(item));
            if (typeof item === 'string' && item.match(urlRegex)) {
              output.push(`<a href="${item}" target="_blank">${visible}</a>`);
            } else {
              output.push(visible);
            }
          }
          td.innerHTML = output.join(", ");
          tr.appendChild(td);
        }
      });
    }
    bom.appendChild(tr);
    var handler = createRowHighlightHandler(tr.id, references, netname);
    tr.onmousemove = handler;
    highlightHandlers.push({
      id: tr.id,
      handler: handler,
    });
    if (references !== null) {
      for (var refIndex of references.map(r => r[1])) {
        footprintIndexToHandler[refIndex] = handler;
      }
    }
    if (netname !== null) {
      netsToHandler[netname] = handler;
    }
    if ((filter || reflookup) && first) {
      handler();
      first = false;
    }
  }
  EventHandler.emitEvent(
    IBOM_EVENT_TYPES.BOM_BODY_CHANGE_EVENT, {
    filter: filter,
    reflookup: reflookup,
    checkboxes: settings.checkboxes,
    bommode: settings.bommode,
  });
}

function highlightPreviousRow() {
  if (!currentHighlightedRowId) {
    highlightHandlers[highlightHandlers.length - 1].handler();
  } else {
    if (highlightHandlers.length > 1 &&
      highlightHandlers[0].id == currentHighlightedRowId) {
      highlightHandlers[highlightHandlers.length - 1].handler();
    } else {
      for (var i = 0; i < highlightHandlers.length - 1; i++) {
        if (highlightHandlers[i + 1].id == currentHighlightedRowId) {
          highlightHandlers[i].handler();
          break;
        }
      }
    }
  }
  smoothScrollToRow(currentHighlightedRowId);
}

function highlightNextRow() {
  if (!currentHighlightedRowId) {
    highlightHandlers[0].handler();
  } else {
    if (highlightHandlers.length > 1 &&
      highlightHandlers[highlightHandlers.length - 1].id == currentHighlightedRowId) {
      highlightHandlers[0].handler();
    } else {
      for (var i = 1; i < highlightHandlers.length; i++) {
        if (highlightHandlers[i - 1].id == currentHighlightedRowId) {
          highlightHandlers[i].handler();
          break;
        }
      }
    }
  }
  smoothScrollToRow(currentHighlightedRowId);
}

function populateBomTable() {
  populateBomHeader();
  populateBomBody();
  setBomHandlers();
  resizableGrid(bomhead);
}

function footprintsClicked(footprintIndexes) {
  var lastClickedIndex = footprintIndexes.indexOf(lastClicked);
  for (var i = 1; i <= footprintIndexes.length; i++) {
    var refIndex = footprintIndexes[(lastClickedIndex + i) % footprintIndexes.length];
    if (refIndex in footprintIndexToHandler) {
      lastClicked = refIndex;
      footprintIndexToHandler[refIndex]();
      smoothScrollToRow(currentHighlightedRowId);
      break;
    }
  }
}

function netClicked(net) {
  if (net in netsToHandler) {
    netsToHandler[net]();
    smoothScrollToRow(currentHighlightedRowId);
  } else {
    clearHighlightedFootprints();
    highlightedNet = net;
    drawHighlights();
  }
}

function updateFilter(input) {
  filter = input.toLowerCase();
  populateBomTable();
}

function updateRefLookup(input) {
  reflookup = input.toLowerCase();
  populateBomTable();
}

function changeCanvasLayout(layout) {
  document.getElementById("fl-btn").classList.remove("depressed");
  document.getElementById("fb-btn").classList.remove("depressed");
  document.getElementById("bl-btn").classList.remove("depressed");
  switch (layout) {
    case 'F':
      document.getElementById("fl-btn").classList.add("depressed");
      if (settings.bomlayout != "bom-only") {
        canvassplit.collapse(1);
      }
      break;
    case 'B':
      document.getElementById("bl-btn").classList.add("depressed");
      if (settings.bomlayout != "bom-only") {
        canvassplit.collapse(0);
      }
      break;
    default:
      document.getElementById("fb-btn").classList.add("depressed");
      if (settings.bomlayout != "bom-only") {
        canvassplit.setSizes([50, 50]);
      }
  }
  settings.canvaslayout = layout;
  writeStorage("canvaslayout", layout);
  resizeAll();
  changeBomMode(settings.bommode);
}

function populateMetadata() {
  document.getElementById("title").innerHTML = pcbdata.metadata.title;
  document.getElementById("revision").innerHTML = "Rev: " + pcbdata.metadata.revision;
  document.getElementById("company").innerHTML = pcbdata.metadata.company;
  document.getElementById("filedate").innerHTML = pcbdata.metadata.date;
  if (pcbdata.metadata.title != "") {
    document.title = pcbdata.metadata.title + " BOM";
  }
  // Calculate board stats
  var fp_f = 0,
    fp_b = 0,
    pads_f = 0,
    pads_b = 0,
    pads_th = 0;
  for (var i = 0; i < pcbdata.footprints.length; i++) {
    if (pcbdata.bom.skipped.includes(i)) continue;
    var mod = pcbdata.footprints[i];
    if (mod.layer == "F") {
      fp_f++;
    } else {
      fp_b++;
    }
    for (var pad of mod.pads) {
      if (pad.type == "th") {
        pads_th++;
      } else {
        if (pad.layers.includes("F")) {
          pads_f++;
        }
        if (pad.layers.includes("B")) {
          pads_b++;
        }
      }
    }
  }
  document.getElementById("stats-components-front").innerHTML = fp_f;
  document.getElementById("stats-components-back").innerHTML = fp_b;
  document.getElementById("stats-components-total").innerHTML = fp_f + fp_b;
  document.getElementById("stats-groups-front").innerHTML = pcbdata.bom.F.length;
  document.getElementById("stats-groups-back").innerHTML = pcbdata.bom.B.length;
  document.getElementById("stats-groups-total").innerHTML = pcbdata.bom.both.length;
  document.getElementById("stats-smd-pads-front").innerHTML = pads_f;
  document.getElementById("stats-smd-pads-back").innerHTML = pads_b;
  document.getElementById("stats-smd-pads-total").innerHTML = pads_f + pads_b;
  document.getElementById("stats-th-pads").innerHTML = pads_th;
  // Update version string
  document.getElementById("github-link").innerHTML = "InteractiveHtmlBom&nbsp;" +
    /^v\d+\.\d+/.exec(pcbdata.ibom_version)[0];
}

function changeBomLayout(layout) {
  document.getElementById("bom-btn").classList.remove("depressed");
  document.getElementById("lr-btn").classList.remove("depressed");
  document.getElementById("tb-btn").classList.remove("depressed");
  switch (layout) {
    case 'bom-only':
      document.getElementById("bom-btn").classList.add("depressed");
      if (bomsplit) {
        bomsplit.destroy();
        bomsplit = null;
        canvassplit.destroy();
        canvassplit = null;
      }
      document.getElementById("frontcanvas").style.display = "none";
      document.getElementById("backcanvas").style.display = "none";
      document.getElementById("topmostdiv").style.height = "";
      document.getElementById("topmostdiv").style.display = "block";
      break;
    case 'top-bottom':
      document.getElementById("tb-btn").classList.add("depressed");
      document.getElementById("frontcanvas").style.display = "";
      document.getElementById("backcanvas").style.display = "";
      document.getElementById("topmostdiv").style.height = "100%";
      document.getElementById("topmostdiv").style.display = "flex";
      document.getElementById("bomdiv").classList.remove("split-horizontal");
      document.getElementById("canvasdiv").classList.remove("split-horizontal");
      document.getElementById("frontcanvas").classList.add("split-horizontal");
      document.getElementById("backcanvas").classList.add("split-horizontal");
      if (bomsplit) {
        bomsplit.destroy();
        bomsplit = null;
        canvassplit.destroy();
        canvassplit = null;
      }
      bomsplit = Split(['#bomdiv', '#canvasdiv'], {
        sizes: [50, 50],
        onDragEnd: resizeAll,
        direction: "vertical",
        gutterSize: 5
      });
      canvassplit = Split(['#frontcanvas', '#backcanvas'], {
        sizes: [50, 50],
        gutterSize: 5,
        onDragEnd: resizeAll
      });
      break;
    case 'left-right':
      document.getElementById("lr-btn").classList.add("depressed");
      document.getElementById("frontcanvas").style.display = "";
      document.getElementById("backcanvas").style.display = "";
      document.getElementById("topmostdiv").style.height = "100%";
      document.getElementById("topmostdiv").style.display = "flex";
      document.getElementById("bomdiv").classList.add("split-horizontal");
      document.getElementById("canvasdiv").classList.add("split-horizontal");
      document.getElementById("frontcanvas").classList.remove("split-horizontal");
      document.getElementById("backcanvas").classList.remove("split-horizontal");
      if (bomsplit) {
        bomsplit.destroy();
        bomsplit = null;
        canvassplit.destroy();
        canvassplit = null;
      }
      bomsplit = Split(['#bomdiv', '#canvasdiv'], {
        sizes: [50, 50],
        onDragEnd: resizeAll,
        gutterSize: 5
      });
      canvassplit = Split(['#frontcanvas', '#backcanvas'], {
        sizes: [50, 50],
        gutterSize: 5,
        direction: "vertical",
        onDragEnd: resizeAll
      });
  }
  settings.bomlayout = layout;
  writeStorage("bomlayout", layout);
  changeCanvasLayout(settings.canvaslayout);
}

function changeBomMode(mode) {
  document.getElementById("bom-grouped-btn").classList.remove("depressed");
  document.getElementById("bom-ungrouped-btn").classList.remove("depressed");
  document.getElementById("bom-netlist-btn").classList.remove("depressed");
  var chkbxs = document.getElementsByClassName("visibility_checkbox");

  switch (mode) {
    case 'grouped':
      document.getElementById("bom-grouped-btn").classList.add("depressed");
      for (var i = 0; i < chkbxs.length; i++) {
        chkbxs[i].disabled = false;
      }
      break;
    case 'ungrouped':
      document.getElementById("bom-ungrouped-btn").classList.add("depressed");
      for (var i = 0; i < chkbxs.length; i++) {
        chkbxs[i].disabled = false;
      }
      break;
    case 'netlist':
      document.getElementById("bom-netlist-btn").classList.add("depressed");
      for (var i = 0; i < chkbxs.length; i++) {
        chkbxs[i].disabled = true;
      }
  }

  writeStorage("bommode", mode);
  if (mode != settings.bommode) {
    settings.bommode = mode;
    bomSortFunction = null;
    currentSortColumn = null;
    currentSortOrder = null;
    clearHighlightedFootprints();
  }
  populateBomTable();
}

function focusFilterField() {
  focusInputField(document.getElementById("filter"));
}

function focusRefLookupField() {
  focusInputField(document.getElementById("reflookup"));
}

function toggleBomCheckbox(bomrowid, checkboxnum) {
  if (!bomrowid || checkboxnum > settings.checkboxes.length) {
    return;
  }
  var bomrow = document.getElementById(bomrowid);
  var checkbox = bomrow.childNodes[checkboxnum].childNodes[0];
  checkbox.checked = !checkbox.checked;
  checkbox.indeterminate = false;
  checkbox.onchange();
}

function checkBomCheckbox(bomrowid, checkboxname) {
  var checkboxnum = 0;
  while (checkboxnum < settings.checkboxes.length &&
    settings.checkboxes[checkboxnum].toLowerCase() != checkboxname.toLowerCase()) {
    checkboxnum++;
  }
  if (!bomrowid || checkboxnum >= settings.checkboxes.length) {
    return;
  }
  var bomrow = document.getElementById(bomrowid);
  var checkbox = bomrow.childNodes[checkboxnum + 1].childNodes[0];
  checkbox.checked = true;
  checkbox.indeterminate = false;
  checkbox.onchange();
}

function setBomCheckboxes(value) {
  writeStorage("bomCheckboxes", value);
  settings.checkboxes = value.split(",").map((e) => e.trim()).filter((e) => e);
  prepCheckboxes();
  populateMarkWhenCheckedOptions();
  setMarkWhenChecked(settings.markWhenChecked);
}

function setMarkWhenChecked(value) {
  writeStorage("markWhenChecked", value);
  settings.markWhenChecked = value;
  markedFootprints.clear();
  for (var ref of (value ? getStoredCheckboxRefs(value) : [])) {
    markedFootprints.add(ref);
  }
  populateBomTable();
  drawHighlights();
}

function prepCheckboxes() {
  var table = document.getElementById("checkbox-stats");
  while (table.childElementCount > 1) {
    table.removeChild(table.lastChild);
  }
  if (settings.checkboxes.length) {
    table.style.display = "";
  } else {
    table.style.display = "none";
  }
  for (var checkbox of settings.checkboxes) {
    var tr = document.createElement("TR");
    var td = document.createElement("TD");
    td.innerHTML = checkbox;
    tr.appendChild(td);
    td = document.createElement("TD");
    td.id = "checkbox-stats-" + checkbox;
    var progressbar = document.createElement("div");
    progressbar.classList.add("bar");
    td.appendChild(progressbar);
    var text = document.createElement("div");
    text.classList.add("text");
    td.appendChild(text);
    tr.appendChild(td);
    table.appendChild(tr);
    updateCheckboxStats(checkbox);
  }
}

function populateMarkWhenCheckedOptions() {
  var container = document.getElementById("markWhenCheckedContainer");

  if (settings.checkboxes.length == 0) {
    container.parentElement.style.display = "none";
    return;
  }

  container.innerHTML = '';
  container.parentElement.style.display = "inline-block";

  function createOption(name, displayName) {
    var id = "markWhenChecked-" + name;

    var div = document.createElement("div");
    div.classList.add("radio-container");

    var input = document.createElement("input");
    input.type = "radio";
    input.name = "markWhenChecked";
    input.value = name;
    input.id = id;
    input.onchange = () => setMarkWhenChecked(name);
    div.appendChild(input);

    // Preserve the selected element when the checkboxes change
    if (name == settings.markWhenChecked) {
      input.checked = true;
    }

    var label = document.createElement("label");
    label.innerHTML = displayName;
    label.htmlFor = id;
    div.appendChild(label);

    container.appendChild(div);
  }
  createOption("", "None");
  for (var checkbox of settings.checkboxes) {
    createOption(checkbox, checkbox);
  }
}

function updateCheckboxStats(checkbox) {
  var checked = getStoredCheckboxRefs(checkbox).size;
  var total = pcbdata.footprints.length - pcbdata.bom.skipped.length;
  var percent = checked * 100.0 / total;
  var td = document.getElementById("checkbox-stats-" + checkbox);
  td.firstChild.style.width = percent + "%";
  td.lastChild.innerHTML = checked + "/" + total + " (" + Math.round(percent) + "%)";
}

function constrain(number, min, max) {
  return Math.min(Math.max(parseInt(number), min), max);
}

document.onkeydown = function (e) {
  switch (e.key) {
    case "n":
      if (document.activeElement.type == "text") {
        return;
      }
      if (currentHighlightedRowId !== null) {
        checkBomCheckbox(currentHighlightedRowId, "placed");
        highlightNextRow();
        e.preventDefault();
      }
      break;
    case "ArrowUp":
      highlightPreviousRow();
      e.preventDefault();
      break;
    case "ArrowDown":
      highlightNextRow();
      e.preventDefault();
      break;
    case "ArrowLeft":
    case "ArrowRight":
      if (document.activeElement.type != "text") {
        e.preventDefault();
        let boardRotationElement = document.getElementById("boardRotation")
        settings.boardRotation = parseInt(boardRotationElement.value);  // degrees / 5
        if (e.key == "ArrowLeft") {
          settings.boardRotation += 3;  // 15 degrees
        }
        else {
          settings.boardRotation -= 3;
        }
        settings.boardRotation = constrain(settings.boardRotation, boardRotationElement.min, boardRotationElement.max);
        boardRotationElement.value = settings.boardRotation
        setBoardRotation(settings.boardRotation);
      }
      break;
    default:
      break;
  }
  if (e.altKey) {
    switch (e.key) {
      case "f":
        focusFilterField();
        e.preventDefault();
        break;
      case "r":
        focusRefLookupField();
        e.preventDefault();
        break;
      case "z":
        changeBomLayout("bom-only");
        e.preventDefault();
        break;
      case "x":
        changeBomLayout("left-right");
        e.preventDefault();
        break;
      case "c":
        changeBomLayout("top-bottom");
        e.preventDefault();
        break;
      case "v":
        changeCanvasLayout("F");
        e.preventDefault();
        break;
      case "b":
        changeCanvasLayout("FB");
        e.preventDefault();
        break;
      case "n":
        changeCanvasLayout("B");
        e.preventDefault();
        break;
      default:
        break;
    }
    if (e.key >= '1' && e.key <= '9') {
      toggleBomCheckbox(currentHighlightedRowId, parseInt(e.key));
      e.preventDefault();
    }
  }
}

function hideNetlistButton() {
  document.getElementById("bom-ungrouped-btn").classList.remove("middle-button");
  document.getElementById("bom-ungrouped-btn").classList.add("right-most-button");
  document.getElementById("bom-netlist-btn").style.display = "none";
}

function topToggle() {
  var top = document.getElementById("top");
  var toptoggle = document.getElementById("toptoggle");
  if (top.style.display === "none") {
    top.style.display = "flex";
    toptoggle.classList.remove("flipped");
  } else {
    top.style.display = "none";
    toptoggle.classList.add("flipped");
  }
}

window.onload = function (e) {
  initUtils();
  initRender();
  initStorage();
  initDefaults();
  cleanGutters();
  populateMetadata();
  dbgdiv = document.getElementById("dbg");
  bom = document.getElementById("bombody");
  bomhead = document.getElementById("bomhead");
  filter = "";
  reflookup = "";
  if (!("nets" in pcbdata)) {
    hideNetlistButton();
  }
  initDone = true;
  setBomCheckboxes(document.getElementById("bomCheckboxes").value);
  // Triggers render
  changeBomLayout(settings.bomlayout);

  // Users may leave fullscreen without touching the checkbox. Uncheck.
  document.addEventListener('fullscreenchange', () => {
    if (!document.fullscreenElement)
      document.getElementById('fullscreenCheckbox').checked = false;
  });
}

window.onresize = resizeAll;
window.matchMedia("print").addListener(resizeAll);

///////////////////////////////////////////////

///////////////////////////////////////////////
// EventHandler.registerCallback(IBOM_EVENT_TYPES.BOM_BODY_CHANGE_EVENT, () => {
//     for(var tr of bom.childNodes) {
//         tr.onclick = tr.onmousemove;
//         tr.onmousemove = null;
//     };
// });

///////////////////////////////////////////////
  </script>
</head>

<body>

<div id="topmostdiv" class="topmostdiv">
  <div id="top">
    <div id="fileinfodiv">
      <table class="fileinfo">
        <tbody>
          <tr>
            <td id="title" class="title" style="width: 70%">
              Title
            </td>
            <td id="revision" class="title" style="width: 30%">
              Revision
            </td>
          </tr>
          <tr>
            <td id="company">
              Company
            </td>
            <td id="filedate">
              Date
            </td>
          </tr>
        </tbody>
      </table>
    </div>
    <div id="bomcontrols">
      <div class="hideonprint menu">
        <button class="menubtn"></button>
        <div class="menu-content">
          <label class="menu-label menu-label-top" style="width: calc(50% - 18px)">
            <input id="darkmodeCheckbox" type="checkbox" onchange="setDarkMode(this.checked)">
            Dark mode
          </label><!-- This comment eats space! All of it!
          --><label class="menu-label menu-label-top" style="width: calc(50% - 17px); border-left: 0;">
            <input id="fullscreenCheckbox" type="checkbox" onchange="setFullscreen(this.checked)">
            Full Screen
          </label>
          <label class="menu-label" style="width: calc(50% - 18px)">
            <input id="fabricationCheckbox" type="checkbox" checked onchange="fabricationVisible(this.checked)">
            Fab layer
          </label><!-- This comment eats space! All of it!
          --><label class="menu-label" style="width: calc(50% - 17px); border-left: 0;">
            <input id="silkscreenCheckbox" type="checkbox" checked onchange="silkscreenVisible(this.checked)">
            Silkscreen
          </label>
          <label class="menu-label" style="width: calc(50% - 18px)">
            <input id="referencesCheckbox" type="checkbox" checked onchange="referencesVisible(this.checked)">
            References
          </label><!-- This comment eats space! All of it!
          --><label class="menu-label" style="width: calc(50% - 17px); border-left: 0;">
            <input id="valuesCheckbox" type="checkbox" checked onchange="valuesVisible(this.checked)">
            Values
          </label>
          <div id="tracksAndZonesCheckboxes">
            <label class="menu-label" style="width: calc(50% - 18px)">
              <input id="tracksCheckbox" type="checkbox" checked onchange="tracksVisible(this.checked)">
              Tracks
            </label><!-- This comment eats space! All of it!
            --><label class="menu-label" style="width: calc(50% - 17px); border-left: 0;">
              <input id="zonesCheckbox" type="checkbox" checked onchange="zonesVisible(this.checked)">
              Zones
            </label>
          </div>
          <label class="menu-label" style="width: calc(50% - 18px)">
            <input id="padsCheckbox" type="checkbox" checked onchange="padsVisible(this.checked)">
            Pads
          </label><!-- This comment eats space! All of it!
          --><label class="menu-label" style="width: calc(50% - 17px); border-left: 0;">
            <input id="dnpOutlineCheckbox" type="checkbox" checked onchange="dnpOutline(this.checked)">
            DNP outlined
          </label>
          <label class="menu-label">
            <input id="dragCheckbox" type="checkbox" checked onchange="setRedrawOnDrag(this.checked)">
            Continuous redraw on drag
          </label>
          <label class="menu-label">
            Highlight first pin
            <form id="highlightpin1">
              <div class="flexbox">
                <label>
                  <input type="radio" name="highlightpin1" value="none" onchange="setHighlightPin1('none')">
                  None
                </label>
                <label>
                  <input type="radio" name="highlightpin1" value="all" onchange="setHighlightPin1('all')">
                  All
                </label>
                <label>
                  <input type="radio" name="highlightpin1" value="selected" onchange="setHighlightPin1('selected')">
                  Selected
                </label>
              </div>
            </form>
          </label>
          <label class="menu-label">
            <span>Board rotation</span>
            <span style="float: right"><span id="rotationDegree">0</span>&#176;</span>
            <input id="boardRotation" type="range" min="-36" max="36" value="0" class="slider" oninput="setBoardRotation(this.value)">
          </label>
          <label class="menu-label">
            <input id="offsetBackRotationCheckbox" type="checkbox" onchange="setOffsetBackRotation(this.checked)">
            Offset back rotation
          </label>
          <label class="menu-label">
            <div style="margin-left: 5px">Bom checkboxes</div>
            <input id="bomCheckboxes" class="menu-textbox" type=text
                   oninput="setBomCheckboxes(this.value)">
          </label>
          <label class="menu-label">
            <div style="margin-left: 5px">Mark when checked</div>
            <div id="markWhenCheckedContainer"></div>
          </label>
          <label class="menu-label">
            <span class="shameless-plug">
              <span>Created using</span>
              <a id="github-link" target="blank" href="https://github.com/openscopeproject/InteractiveHtmlBom">InteractiveHtmlBom</a>
              <a target="blank" title="Mouse and keyboard help" href="https://github.com/openscopeproject/InteractiveHtmlBom/wiki/Usage#bom-page-mouse-actions" style="text-decoration: none;"><label class="help-link">?</label></a>
            </span>
          </label>
        </div>
      </div>
      <div class="button-container hideonprint">
        <button id="fl-btn" class="left-most-button" onclick="changeCanvasLayout('F')"
                title="Front only">F
        </button>
        <button id="fb-btn" class="middle-button" onclick="changeCanvasLayout('FB')"
                title="Front and Back">FB
        </button>
        <button id="bl-btn" class="right-most-button" onclick="changeCanvasLayout('B')"
                title="Back only">B
        </button>
      </div>
      <div class="button-container hideonprint">
        <button id="bom-btn" class="left-most-button" onclick="changeBomLayout('bom-only')"
                title="BOM only"></button>
        <button id="lr-btn" class="middle-button" onclick="changeBomLayout('left-right')"
                title="BOM left, drawings right"></button>
        <button id="tb-btn" class="right-most-button" onclick="changeBomLayout('top-bottom')"
                title="BOM top, drawings bot"></button>
      </div>
      <div class="button-container hideonprint">
        <button id="bom-grouped-btn" class="left-most-button" onclick="changeBomMode('grouped')"
                title="Grouped BOM"></button>
        <button id="bom-ungrouped-btn" class="middle-button" onclick="changeBomMode('ungrouped')"
                title="Ungrouped BOM"></button>
        <button id="bom-netlist-btn" class="right-most-button" onclick="changeBomMode('netlist')"
                title="Netlist"></button>
      </div>
      <div class="hideonprint menu">
        <button class="statsbtn"></button>
        <div class="menu-content">
          <table class="stats">
            <tbody>
              <tr>
                <td width="40%">Board stats</td>
                <td>Front</td>
                <td>Back</td>
                <td>Total</td>
              </tr>
              <tr>
                <td>Components</td>
                <td id="stats-components-front">~</td>
                <td id="stats-components-back">~</td>
                <td id="stats-components-total">~</td>
              </tr>
              <tr>
                <td>Groups</td>
                <td id="stats-groups-front">~</td>
                <td id="stats-groups-back">~</td>
                <td id="stats-groups-total">~</td>
              </tr>
              <tr>
                <td>SMD pads</td>
                <td id="stats-smd-pads-front">~</td>
                <td id="stats-smd-pads-back">~</td>
                <td id="stats-smd-pads-total">~</td>
              </tr>
              <tr>
                <td>TH pads</td>
                <td colspan=3 id="stats-th-pads">~</td>
              </tr>
            </tbody>
          </table>
          <table class="stats">
            <col width="40%"/><col />
            <tbody id="checkbox-stats">
              <tr>
                <td colspan=2 style="border-top: 0">Checkboxes</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <div class="hideonprint menu">
        <button class="iobtn"></button>
        <div class="menu-content">
          <div class="menu-label menu-label-top">
            <div style="margin-left: 5px;">Save board image</div>
            <div class="flexbox">
              <input id="render-save-width" class="menu-textbox" type="text" value="1000" placeholder="Width"
                  style="flex-grow: 1; width: 50px;" oninput="validateSaveImgDimension(this)">
              <span>X</span>
              <input id="render-save-height" class="menu-textbox" type="text" value="1000" placeholder="Height"
                  style="flex-grow: 1; width: 50px;" oninput="validateSaveImgDimension(this)">
            </div>
            <label>
              <input id="render-save-transparent" type="checkbox">
              Transparent background
            </label>
            <div class="flexbox">
              <button class="savebtn" onclick="saveImage('F')">Front</button>
              <button class="savebtn" onclick="saveImage('B')">Back</button>
            </div>
          </div>
          <div class="menu-label">
            <span style="margin-left: 5px;">Config and checkbox state</span>
            <div class="flexbox">
              <button class="savebtn" onclick="saveSettings()">Export</button>
              <button class="savebtn" onclick="loadSettings()">Import</button>
              <button class="savebtn" onclick="resetSettings()">Reset</button>
            </div>
          </div>
          <div class="menu-label">
            <span style="margin-left: 5px;">Save bom table as</span>
            <div class="flexbox">
              <button class="savebtn" onclick="saveBomTable('csv')">csv</button>
              <button class="savebtn" onclick="saveBomTable('txt')">txt</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div id="topdivider">
    <div class="hideonprint">
      <div id="toptoggle" onclick="topToggle()"></div>
    </div>
  </div>
  <div id="bot" class="split" style="flex: 1 1">
    <div id="bomdiv" class="split split-horizontal">
      <div style="width: 100%">
        <input id="reflookup" class="textbox searchbox reflookup hideonprint" type="text" placeholder="Ref lookup"
               oninput="updateRefLookup(this.value)">
        <input id="filter" class="textbox searchbox filter hideonprint" type="text" placeholder="Filter"
               oninput="updateFilter(this.value)">
        <div class="button-container hideonprint" style="float: left; margin: 0;">
          <button id="copy" title="Copy bom table to clipboard"
               onclick="saveBomTable('clipboard')"></button>
        </div>
      </div>
      <div id="dbg"></div>
      <table class="bom" id="bomtable">
        <thead id="bomhead">
        </thead>
        <tbody id="bombody">
        </tbody>
      </table>
    </div>
    <div id="canvasdiv" class="split split-horizontal">
      <div id="frontcanvas" class="split" touch-action="none" style="overflow: hidden">
        <div style="position: relative; width: 100%; height: 100%;">
          <canvas id="F_bg" style="position: absolute; left: 0; top: 0; z-index: 0;"></canvas>
          <canvas id="F_fab" style="position: absolute; left: 0; top: 0; z-index: 1;"></canvas>
          <canvas id="F_slk" style="position: absolute; left: 0; top: 0; z-index: 2;"></canvas>
          <canvas id="F_hl" style="position: absolute; left: 0; top: 0; z-index: 3;"></canvas>
        </div>
      </div>
      <div id="backcanvas" class="split" touch-action="none" style="overflow: hidden">
        <div style="position: relative; width: 100%; height: 100%;">
          <canvas id="B_bg" style="position: absolute; left: 0; top: 0; z-index: 0;"></canvas>
          <canvas id="B_fab" style="position: absolute; left: 0; top: 0; z-index: 1;"></canvas>
          <canvas id="B_slk" style="position: absolute; left: 0; top: 0; z-index: 2;"></canvas>
          <canvas id="B_hl" style="position: absolute; left: 0; top: 0; z-index: 3;"></canvas>
        </div>
      </div>
    </div>
  </div>
</div>

</body>

</html>
